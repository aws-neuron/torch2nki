## https://github.com/aws-neuron/aws-neuron-samples/blob/master/torch-neuronx/transformers-neuronx/inference/facebook-opt-66b-sampling.ipynb

aws-neuron-samples/torch-neuronx/transformers-neuronx/inference/facebook-opt-66b-sampling.ipynb at master · aws-neuron/aws-neuron-samples · GitHub Skip to content Navigation Menu Toggle navigation Sign in Product GitHub Copilot Write better code with AI Security Find and fix vulnerabilities Actions Automate any workflow Codespaces Instant dev environments Issues Plan and track work Code Review Manage code changes Discussions Collaborate outside of code Code Search Find more, search less Explore All features Documentation GitHub Skills Blog Solutions By company size Enterprises Small and medium teams Startups Nonprofits By use case DevSecOps DevOps CI/CD View all use cases By industry Healthcare Financial services Manufacturing Government View all industries View all solutions Resources Topics AI DevOps Security Software Development View all Explore Learning Pathways Events & Webinars Ebooks & Whitepapers Customer Stories Partners Executive Insights Open Source GitHub Sponsors Fund open source developers The ReadME Project GitHub community articles Repositories Topics Trending Collections Enterprise Enterprise platform AI-powered developer platform Available add-ons Advanced Security Enterprise-grade security features Copilot for business Enterprise-grade AI features Premium Support Enterprise-grade 24/7 support Pricing Search or jump to... Search code, repositories, users, issues, pull requests... Search Clear Search syntax tips Provide feedback We read every piece of feedback, and take your input very seriously. Include my email address so I can be contacted Cancel Submit feedback Saved searches Use saved searches to filter your results more quickly Name Query To see all available qualifiers, see our documentation . Cancel Create saved search Sign in Sign up Reseting focus You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert aws-neuron / aws-neuron-samples Public Notifications You must be signed in to change notification settings Fork 38 Star 137 Code Issues 12 Pull requests 11 Actions Projects 0 Security Insights Additional navigation options Code Issues Pull requests Actions Projects Security Insights Files master Breadcrumbs aws-neuron-samples / torch-neuronx / transformers-neuronx / inference / facebook-opt-66b-sampling.ipynb Copy path Blame Blame Latest commit History History 259 lines (259 loc) · 12.6 KB master Breadcrumbs aws-neuron-samples / torch-neuronx / transformers-neuronx / inference / facebook-opt-66b-sampling.ipynb Top File metadata and controls Preview Code Blame 259 lines (259 loc) · 12.6 KB Raw Loading Viewer requires iframe. Footer © 2025 GitHub, Inc. Footer navigation Terms Privacy Security Status Docs Contact Manage cookies Do not share my personal information You can’t perform that action at this time.

## https://github.com/aws-neuron/aws-neuron-samples/tree/master/torch-neuron/inference

aws-neuron-samples/torch-neuron/inference at master · aws-neuron/aws-neuron-samples · GitHub Skip to content Navigation Menu Toggle navigation Sign in Product GitHub Copilot Write better code with AI Security Find and fix vulnerabilities Actions Automate any workflow Codespaces Instant dev environments Issues Plan and track work Code Review Manage code changes Discussions Collaborate outside of code Code Search Find more, search less Explore All features Documentation GitHub Skills Blog Solutions By company size Enterprises Small and medium teams Startups Nonprofits By use case DevSecOps DevOps CI/CD View all use cases By industry Healthcare Financial services Manufacturing Government View all industries View all solutions Resources Topics AI DevOps Security Software Development View all Explore Learning Pathways Events & Webinars Ebooks & Whitepapers Customer Stories Partners Executive Insights Open Source GitHub Sponsors Fund open source developers The ReadME Project GitHub community articles Repositories Topics Trending Collections Enterprise Enterprise platform AI-powered developer platform Available add-ons Advanced Security Enterprise-grade security features Copilot for business Enterprise-grade AI features Premium Support Enterprise-grade 24/7 support Pricing Search or jump to... Search code, repositories, users, issues, pull requests... Search Clear Search syntax tips Provide feedback We read every piece of feedback, and take your input very seriously. Include my email address so I can be contacted Cancel Submit feedback Saved searches Use saved searches to filter your results more quickly Name Query To see all available qualifiers, see our documentation . Cancel Create saved search Sign in Sign up Reseting focus You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert aws-neuron / aws-neuron-samples Public Notifications You must be signed in to change notification settings Fork 38 Star 137 Code Issues 12 Pull requests 11 Actions Projects 0 Security Insights Additional navigation options Code Issues Pull requests Actions Projects Security Insights Files master Breadcrumbs aws-neuron-samples / torch-neuron / inference / Copy path Directory actions More options Directory actions More options Latest commit History History master Breadcrumbs aws-neuron-samples / torch-neuron / inference / Top Folders and files Name Name Last commit message Last commit date parent directory .. beit beit bertbasecased bertbasecased bertlargeuncased bertlargeuncased clip clip common common craft craft efficientnet efficientnet fairseq fairseq gfl_mmdet gfl_mmdet hrnet hrnet marianmt marianmt rcnn rcnn resnet resnet resnext resnext robertabase robertabase ssd ssd trocr trocr vgg vgg vit vit yolof_detectron2 yolof_detectron2 yolov5 yolov5 yolov6 yolov6 yolov7 yolov7 View all files Footer © 2025 GitHub, Inc. Footer navigation Terms Privacy Security Status Docs Contact Manage cookies Do not share my personal information You can’t perform that action at this time.

## https://github.com/aws-neuron/neuronx-nemo-megatron

GitHub - aws-neuron/neuronx-nemo-megatron Skip to content Navigation Menu Toggle navigation Sign in Product GitHub Copilot Write better code with AI Security Find and fix vulnerabilities Actions Automate any workflow Codespaces Instant dev environments Issues Plan and track work Code Review Manage code changes Discussions Collaborate outside of code Code Search Find more, search less Explore All features Documentation GitHub Skills Blog Solutions By company size Enterprises Small and medium teams Startups Nonprofits By use case DevSecOps DevOps CI/CD View all use cases By industry Healthcare Financial services Manufacturing Government View all industries View all solutions Resources Topics AI DevOps Security Software Development View all Explore Learning Pathways Events & Webinars Ebooks & Whitepapers Customer Stories Partners Executive Insights Open Source GitHub Sponsors Fund open source developers The ReadME Project GitHub community articles Repositories Topics Trending Collections Enterprise Enterprise platform AI-powered developer platform Available add-ons Advanced Security Enterprise-grade security features Copilot for business Enterprise-grade AI features Premium Support Enterprise-grade 24/7 support Pricing Search or jump to... Search code, repositories, users, issues, pull requests... Search Clear Search syntax tips Provide feedback We read every piece of feedback, and take your input very seriously. Include my email address so I can be contacted Cancel Submit feedback Saved searches Use saved searches to filter your results more quickly Name Query To see all available qualifiers, see our documentation . Cancel Create saved search Sign in Sign up Reseting focus You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert aws-neuron / neuronx-nemo-megatron Public Notifications You must be signed in to change notification settings Fork 12 Star 35 35 stars 12 forks Branches Tags Activity Star Notifications You must be signed in to change notification settings Code Issues 1 Pull requests 7 Actions Projects 0 Security Insights Additional navigation options Code Issues Pull requests Actions Projects Security Insights aws-neuron/neuronx-nemo-megatron main Branches Tags Go to file Code Folders and files Name Name Last commit message Last commit date Latest commit History 60 Commits apex apex k8s k8s nemo nemo .DS_Store .DS_Store CODEOWNERS CODEOWNERS CODE_OF_CONDUCT.md CODE_OF_CONDUCT.md CONTRIBUTING.md CONTRIBUTING.md Dockerfile Dockerfile README.md README.md THIRD-PARTY-LICENSES THIRD-PARTY-LICENSES build.sh build.sh requirements-docker.txt requirements-docker.txt requirements.txt requirements.txt View all files Repository files navigation README Code of conduct Security This project "AWS Neuron Reference for NeMo Megatron" includes modified versions of the open-source packages NeMo and Apex that have been adapted for use with AWS Neuron and AWS EC2 Trn1 instances. Please refer to the neuronx-nemo-megatron GPT-3 pretraining tutorial for instructions on how to use the code in this repository. Building inside docker The following instructions have been verified to run on 763104351884.dkr.ecr.us-west-2.amazonaws.com/pytorch-training-neuronx:1.13.1-neuronx-py310-sdk2.12.0-ubuntu20.04 These instructions should be periodically updated for new docker images. Latest docker images can be found in https://github.com/aws/deep-learning-containers/blob/master/available_images.md Authenticate for AWS ECR repository access to latest docker image aws ecr get-login-password --region us-west-2 | docker login --username AWS --password-stdin 763104351884.dkr.ecr.us-west-2.amazonaws.com Build the docker image docker build -t neuron-nemo-megatron:dev . You can now use this docker image to run neuron-nemo-megatron code, for e.g. cd /workspace/nemo/nemo/examples/nlp/language_modeling && ./test_llama.sh About No description, website, or topics provided. Resources Readme Code of conduct Code of conduct Security policy Security policy Activity Custom properties Stars 35 stars Watchers 31 watching Forks 12 forks Report repository Releases No releases published Packages 0 No packages published Contributors 24 + 10 contributors Languages Python 58.1% Jupyter Notebook 33.2% Cuda 4.0% C++ 3.6% Shell 0.6% TeX 0.2% Other 0.3% Footer © 2025 GitHub, Inc. Footer navigation Terms Privacy Security Status Docs Contact Manage cookies Do not share my personal information You can’t perform that action at this time.

## https://awsdocs-neuron.readthedocs-hosted.com/en/latest/general/announcements/index.html

All Posts — AWS Neuron Documentation Skip to main content Ctrl + K Neuron 2.21.1 is released! check What's New and Announcements Ctrl + K Search Engine: Default Google Overview Quick Links Ask Q Developer Get Started with Neuron Samples and Tutorials Training on Trn1 Inference on Inf2 and Trn1 Inference on Inf1 Performance What’s New Announcements ML Frameworks PyTorch Neuron Pytorch Neuron Setup Inference (Inf2, Trn1, Trn2) Tutorials Compiling and Deploying HuggingFace Pretrained BERT on Trn1 or Inf2 BERT TorchServe Tutorial LibTorch C++ Tutorial Compiling and Deploying ResNet50 on Trn1 or Inf2 T5 model inference on Trn1 or Inf2 Additional Examples AWS Neuron Samples GitHub Repository Transformers Neuron GitHub samples API Reference Guide PyTorch NeuronX Tracing API for Inference PyTorch Neuron ( torch-neuronx ) Weight Replacement API for Inference PyTorch NeuronX NeuronCore Placement APIs [Beta] PyTorch NeuronX Analyze API for Inference PyTorch NeuronX DataParallel API Developer Guide NeuronCore Allocation and Model Placement for Inference ( torch-neuronx ) Comparison of Traced Inference versus XLA Lazy Tensor Inference ( torch-neuronx ) Data Parallel Inference on torch_neuronx Misc PyTorch Neuron ( torch-neuronx ) release notes Inference (Inf1) Tutorials Computer Vision Tutorials Natural Language Processing (NLP) Tutorials Utilizing Neuron Capabilities Tutorials Additional Examples AWS Neuron Samples GitHub Repository API Reference Guide PyTorch Neuron trace Python API torch.neuron.DataParallel API PyTorch Neuron ( torch-neuron ) Core Placement API [Beta] Developer Guide Running Inference on Variable Input Shapes with Bucketing Data Parallel Inference on PyTorch Neuron Developer Guide - PyTorch Neuron ( torch-neuron ) LSTM Support PyTorch Neuron ( torch-neuron ) Core Placement Misc PyTorch Neuron ( torch-neuron ) Supported operators Troubleshooting Guide for PyTorch Neuron ( torch-neuron ) PyTorch Neuron ( torch-neuron ) release notes Training Tutorials Hugging Face BERT Pretraining Tutorial (Data-Parallel) Multi-Layer Perceptron Training Tutorial PyTorch Neuron for Trainium Hugging Face BERT MRPC task finetuning using Hugging Face Trainer API Fine-tune T5 model on Trn1 ZeRO-1 Tutorial Analyze for Training Tutorial Neuron Custom C++ Operators in MLP Training Neuron Custom C++ Operators Performance Optimization Additional Examples AWS Neuron Reference for Nemo Megatron GitHub Repository AWS Neuron Samples for EKS AWS Neuron Samples for AWS ParallelCluster AWS Neuron Samples GitHub Repository API Reference Guide PyTorch NeuronX neuron_parallel_compile CLI PyTorch NeuronX Environment Variables Neuron Persistent Cache PyTorch NeuronX Profiling API Developer Guide Developer Guide for Training with PyTorch NeuronX How to debug models in PyTorch NeuronX Developer Guide for Profiling with PyTorch NeuronX Misc PyTorch Neuron ( torch-neuronx ) - Supported Operators How to prepare trn1.32xlarge for multi-node execution PyTorch Neuron ( torch-neuronx ) for Training Troubleshooting Guide PyTorch Neuron ( torch-neuronx ) release notes JAX Neuron JAX Neuron plugin Setup JAX Neuron Known issues TensorFlow Neuron Tensorflow Neuron Setup Inference (Inf2 & Trn1) Tutorials HuggingFace Roberta-Base Using NEURON_RT_VISIBLE_CORES with TensorFlow Serving API Reference Guide TensorFlow 2.x ( tensorflow-neuronx ) Tracing API TensorFlow 2.x ( tensorflow-neuronx ) Auto Multicore Replication (Beta) TensorFlow 2.x ( tensorflow-neuronx ) analyze_model API Misc TensorFlow 2.x ( tensorflow-neuronx ) Release Notes Inference (Inf1) Tutorials Natural Language Processing (NLP) Tutorials Utilizing Neuron Capabilities Tutorials Additional Examples AWS Neuron Samples GitHub Repository API Reference Guide TensorFlow 2.x ( tensorflow-neuron ) Tracing API TensorFlow 2.x ( tensorflow-neuron ) analyze_model API TensorFlow 2.x ( tensorflow-neuron ) Auto Multicore Replication (Beta) Misc TensorFlow 2.x ( tensorflow-neuron ) Release Notes TensorFlow 2.x ( tensorflow-neuron ) Accelerated ( torch-neuron ) Python APIs and Graph Ops NeuronX Distributed (NxD) NxD Training (Beta) Overview Setup App Notes Introducing NxD Training Tensor Parallelism Overview Pipeline Parallelism Overview Activation Memory Reduction API Reference Guide YAML Configuration Settings Developer Guides Integrating a new model Integrating a new dataset/dataloader Registering an optimizer and LR scheduler Migrating from Neuron-NeMo-Megatron to Neuronx Distributed Training NxD Training Compatibility with NeMo Tutorials Megatron GPT Pretraining HuggingFace Llama3-8B Pretraining HuggingFace LLama3-8B Supervised Fine-tuning HuggingFace Llama3-8B Direct Preference Optimization (DPO) based Fine-tuning HuggingFace Llama3-70B, Llama3.1-70B Pretraining Checkpoint Conversion Misc NxD Training Release Notes ( neuronx-distributed-training ) Known Issues and Workarounds NxD Inference (Beta) Overview NxD Inference Overview Setup API Reference Guide NxD Inference API Reference Developer Guides NxD Inference Features Configuration Guide NxD Inference - Production Ready Models Onboarding models to run on NxD Inference vLLM User Guide for NxD Inference Migrating from NxD Core inference examples to NxD Inference Migrating from Transformers NeuronX to  NeuronX Distributed(NxD) Inference LLM Inference Benchmarking guide Tutorials Tutorial: Deploying Llama3.1 405B (Trn2) Tutorial: Deploying Llama3.2 Multimodal Models Tutorial: Using Speculative Decoding to improve Llama-3.3-70B inference performance on Trn2 instances Tutorial: Using Speculative Decoding and Quantization to improve Llama-3.1-405B inference performance on Trn2 instances App Notes Introducing NeuronX Distributed (NxD) Inference Misc NxD Inference Release Notes ( neuronx-distributed-inference ) NxD Core Setup App Notes Tensor Parallelism Overview Pipeline Parallelism Overview Activation Memory Reduction API Reference Guide Distributed Strategies APIs Training APIs Inference APIs Developer Guide Training Developer Guides Developer guide for Tensor Parallelism Developer guide for Pipeline Parallelism Developer guide for Activation Memory reduction Developer guide for save/load checkpoint Developer guide for Neuron-PT-Lightning Developer guide for model and optimizer wrapper Developer guide for LoRA finetuning Inference Developer Guide Developer guide for Neuronx-Distributed  Inference Tutorials Training Tutorials Training using Tensor Parallelism Training GPT-NeoX 6.9B using TP and ZeRO-1 Training GPT-NeoX 20B using TP and ZeRO-1 Training Llama 3.1 8B/Llama 3 8B/Llama 2 7B using TP and ZeRO-1 Training Llama 3.1 70B/Llama 3 70B/Llama 2 13B/70B using TP and PP Training Llama-2-7B/13B/70B using TP and PP with PyTorch-Lightning Inference Tutorials T5 inference with Tensor Parallelism Llama-2-7b Inference Misc NxD Core Release Notes ( neuronx-distributed ) Additional ML Libraries Third Party Libraries Transformers Neuron Setup Developer Guide Transformers NeuronX ( transformers-neuronx ) Developer Guide Transformers NeuronX ( transformers-neuronx ) Developer Guide for Continuous Batching Tutorials Hugging Face meta-llama/Llama-2-13b autoregressive sampling on Inf2 & Trn1 Hugging Face facebook/opt-13b autoregressive sampling on Inf2 & Trn1 Hugging Face facebook/opt-30b autoregressive sampling on Inf2 & Trn1 Hugging Face facebook/opt-66b autoregressive sampling on Inf2 Misc Transformers Neuron ( transformers-neuronx ) release notes AWS Neuron reference for NeMo Megatron Developer Flows Neuron DLAMI Neuron Containers Getting started with Neuron DLC using Docker Neuron Deep Learning Containers Customize Neuron DLC Neuron Plugins for Containerized Environments Neuron Containers FAQ AWS Workload Orchestration Amazon EKS Using Neuron with Amazon EKS Deploy Neuron Container on Elastic Kubernetes Service (EKS) for Inference Deploy a simple mlp training script as a Kubernetes job Amazon ECS Neuron Problem Detector And Recovery Deploy Neuron Container on Elastic Container Service (ECS) for Inference Deploy Neuron Container on Elastic Container Service (ECS) for Training AWS ParallelCluster Parallel Cluster Flows- Training Train your model on ParallelCluster AWS Batch Train your model on AWS Batch Amazon SageMaker Third-party Solutions Setup Guide Launching Inf/Trn instances on Amazon EC2 Inference Compile with Framework API and Deploy on EC2 Inf1 Compile with Framework API and Deploy on EC2 Inf2 Training Train your model on EC2 PyTorch NeuronX (torch-neuronx) PyTorch Neuron (torch-neuron) JAX NeuronX JAX Neuron plugin Setup JAX Neuron Known issues Tensorflow NeuronX (tensorflow-neuronx) Tensorflow Neuron (tensorflow-neuron) MxNet Neuron (mxnet-neuron) Runtime & Tools Neuron Runtime API Reference Guide Runtime API Configuration Guide Runtime Configuration Misc Troubleshooting on Inf1 and Trn1 FAQ Neuron Runtime Release Notes Neuron Driver Release Notes Neuron Collectives Release Notes Monitoring Tools Neuron-Monitor User Guide Neuron-Top User Guide Neuron-LS User Guide Neuron-Sysfs User Guide NCCOM-TEST User Guide What's New Profiling Tools Neuron Profiler User Guide Neuron Profiler 2.0 (Beta) User Guide Neuron-DET User guide What's New Third-party Solutions Other Tools Check Model GatherInfo NeuronPerf Neuron Calculator TensorBoard Plugin for Neuron (Trn1) TensorBoard Plugin for Neuron (Inf1) Track Training Progress in TensorBoard using PyTorch Neuron TensorBoard What's New Compiler Neuron Compiler NeuronX Compiler for Trn1 & Inf2 API Reference Guide Neuron Compiler CLI Reference Guide Developer Guide Mixed Precision and Performance-accuracy Tuning ( neuronx-cc ) Misc FAQ What's New Neuron Compiler for Inf1 API Reference Guide Neuron compiler CLI Reference Guide ( neuron-cc ) Developer Guide Mixed precision and performance-accuracy tuning ( neuron-cc ) Misc FAQ What's New Neuron Supported operators Neuron Kernel Interface (Beta) API Reference Manual nki nki.jit nki.benchmark nki.baremetal nki.simulate_kernel nki.tensor nki.language nki.language.load nki.language.store nki.language.load_transpose2d nki.language.atomic_rmw nki.language.copy nki.language.ndarray nki.language.zeros nki.language.zeros_like nki.language.ones nki.language.full nki.language.rand nki.language.random_seed nki.language.shared_constant nki.language.shared_identity_matrix nki.language.add nki.language.subtract nki.language.multiply nki.language.divide nki.language.power nki.language.maximum nki.language.minimum nki.language.max nki.language.min nki.language.mean nki.language.var nki.language.sum nki.language.prod nki.language.all nki.language.abs nki.language.negative nki.language.sign nki.language.trunc nki.language.floor nki.language.ceil nki.language.exp nki.language.log nki.language.cos nki.language.sin nki.language.tan nki.language.tanh nki.language.arctan nki.language.sqrt nki.language.rsqrt nki.language.sigmoid nki.language.relu nki.language.gelu nki.language.gelu_dx nki.language.gelu_apprx_tanh nki.language.silu nki.language.silu_dx nki.language.erf nki.language.erf_dx nki.language.softplus nki.language.mish nki.language.square nki.language.softmax nki.language.rms_norm nki.language.dropout nki.language.matmul nki.language.transpose nki.language.bitwise_and nki.language.bitwise_or nki.language.bitwise_xor nki.language.invert nki.language.left_shift nki.language.right_shift nki.language.equal nki.language.not_equal nki.language.greater nki.language.greater_equal nki.language.less nki.language.less_equal nki.language.logical_and nki.language.logical_or nki.language.logical_xor nki.language.logical_not nki.language.ds nki.language.arange nki.language.mgrid nki.language.expand_dims nki.language.where nki.language.all_reduce nki.language.static_range nki.language.affine_range nki.language.sequential_range nki.language.par_dim nki.language.psum nki.language.sbuf nki.language.hbm nki.language.private_hbm nki.language.shared_hbm nki.language.program_id nki.language.num_programs nki.language.program_ndim nki.language.spmd_dim nki.language.nc nki.language.device_print nki.language.loop_reduce nki.language.tfloat32 nki.language.bfloat16 nki.language.float8_e4m3 nki.language.float8_e5m2 nki.language.tile_size nki.isa nki.isa.nc_matmul nki.isa.nc_transpose nki.isa.activation nki.isa.activation_reduce nki.isa.tensor_reduce nki.isa.tensor_partition_reduce nki.isa.tensor_tensor nki.isa.tensor_tensor_scan nki.isa.scalar_tensor_tensor nki.isa.tensor_scalar nki.isa.tensor_scalar_reduce nki.isa.tensor_copy nki.isa.tensor_copy_dynamic_src nki.isa.reciprocal nki.isa.iota nki.isa.dropout nki.isa.affine_select nki.isa.memset nki.isa.bn_stats nki.isa.bn_aggr nki.isa.local_gather nki.isa.dma_copy nki.isa.tensor_engine nki.isa.vector_engine nki.isa.scalar_engine nki.isa.gpsimd_engine nki.isa.dma_engine nki.isa.unknown_engine nki.isa.nc_version nki.isa.get_nc_version nki.compiler nki.compiler.sbuf.alloc nki.compiler.sbuf.mod_alloc nki.compiler.sbuf.auto_alloc nki.compiler.psum.alloc nki.compiler.psum.mod_alloc nki.compiler.psum.auto_alloc nki.compiler.skip_middle_end_transformations nki.compiler.enable_stack_allocator nki.compiler.force_auto_alloc NKI API Common Fields NKI API Errors Developer Guide Getting Started with NKI NKI Programming Model NKI Kernel as a Framework Custom Operator NeuronDevice Architecture Guide for NKI Trainium/Inferentia2 Architecture Guide for NKI Trainium2 Architecture Guide for NKI Profiling NKI kernels with Neuron Profile NKI Performance Guide NKI Direct Allocation Developer Guide Tutorials Single program, multiple data tensor addition Single program, multiple data tensor addition using multiple Neuron Cores Transpose2D AveragePool2D Matrix multiplication RMSNorm LayerNorm Fused Self Attention Fused Mamba Kernels nki.kernels.fused_self_attn_for_SD_small_head_size nki.kernels.allocated_fused_self_attn_for_SD_small_head_size nki.kernels.allocated_fused_rms_norm_qkv nki.kernels.flash_attn_bwd nki.kernels.resize_nearest_fixed_dma_kernel nki.kernels.flash_fwd nki.kernels.select_and_scatter_kernel Misc NKI FAQ What's New NKI Known Issues Neuron C++ Custom Operators API Reference Guide Custom Operators API Reference Guide [Beta] Developer Guide Neuron Custom C++ Operators Developer Guide [Beta] Tutorials Neuron Custom C++ Operators in MLP Training Neuron Custom C++ Operators Performance Optimization Misc (Neuron Custom C++ Operators) Neuron Custom C++ Tools Release Notes Neuron Custom C++ Library Release Notes Learning Neuron Architecture Trn/Inf Instances Amazon EC2 AI Chips NeuronCores Features Data types Rounding modes Neuron batching NeuronCore pipeline Neuron persistent cache Collective communication Logical NeuronCore configuration Custom C++ operators Application notes Introducing the first release of Neuron 2.x enabling EC2 Trn1 General Availability (GA) Introducing Neuron Runtime 2.x (libnrt.so) Performance Tuning Parallel Execution using NEURON_RT_NUM_CORES Running R-CNNs on Inf1 Graph Partitioner on torch_neuronx Generative LLM inference with Neuron Introducing PyTorch 2.5 Support FAQ Troubleshooting Neuron Glossary Legacy Software Apache MXNet MXNet Neuron Setup Inference (Inf1) Tutorials Computer Vision Tutorials Natural Language Processing (NLP) Tutorials Utilizing Neuron Capabilities Tutorials API Reference Guide Neuron Apache MXNet Compilation Python API Developer Guide Flexible Execution Group (FlexEG) in Neuron-MXNet Misc Troubleshooting Guide for Neuron Apache MXNet What's New Neuron Apache MXNet Supported operators About Neuron Release Details Roadmap Neuron Public Roadmap Support SDK Maintenance Policy Security Disclosures Contact Us Repository Open issue Announcements All
      
    Posts PyTorch Neuron versions 1.9 and 1.10 no longer supported 20 December 2024 en announce-no-support-torch-neuron This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting with Neuron Release 2.21 , Neuron no longer supports torch-neuron 1.9 and 1.10 versions. Current users of torch-neuron 1.9 and 1.10 versions are advised to migrate to the latest torch-neuron supported version. Please see Release Artifacts . Read more ... Announcing migration of NxD Core examples from NxD Core repository to NxD Inference repository in next release 20 December 2024 en announce-eos-nxd-examples This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron Release 2.21 will be the last release to include NxD Core repository inference examples under the NxD Core repository: aws-neuron/neuronx-distributed . Starting with Neuron Release 2.21 , the models and modules in NxD Core inference examples are now available through NxD Inference package. We recommend customers to update their applications to use examples from the NxD Inference repository. See NxD Inference Overview Read more ... Announcing end of support for Ubuntu20 DLCs and DLAMIs 20 December 2024 en announce-u20-dlami-dlc-eos This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting with Neuron Release 2.21 , AWS Neuron will begin phasing out support for Ubuntu20 Deep Learning Containers (DLCs) and Deep Learning AMIs (DLAMIs). Neuron 2.21 will be the last release to provide bug fixes, and by Neuron 2.22, these offerings will no longer be available. Read more ... Announcing end of support for Python 3.8 in future releases 20 December 2024 en announce-python-eos This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Due to Python 3.8 reaching its end-of-life status, future Neuron releases will no longer include support for this version. Read more ... Announcing end of support for PyTorch 2.1 starting next release 20 December 2024 en announce-eos-pytorch-version This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron Release 2.21 is the last release to support PyTorch 2.1, its associated Deep Learning Containers (DLCs), and Deep Learning AMIs (DLAMIS). Read more ... Announcing end of support for PyTorch 1.13 starting next release 20 December 2024 en announce-eos-pytorch-version This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron Release 2.21 is the last release to support PyTorch 1.13, its associated Deep Learning Containers (DLCs), and Deep Learning AMIs (DLAMIS) for Trn1, Trn2, and Inf2 instances. Read more ... Announcing end of support for Neuron DET tool starting next release 20 December 2024 en announce-eos-neuron-det This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron Release 2.21 will be the last release to support the Neuron Distributed Event Tracing (NDET/neuron-det) tool ( Neuron Distributed Event Tracing (NDET) User Guide ). Read more ... ‘neurondevice’ resource name in Neuron Device K8s plugin no longer supported 16 September 2024 en eos-neuron-device neuron-device- This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting with Neuron release 2.20 , Neuron no longer supports resource name ‘neurondevice’. Read more ... ‘neuron-device-version’ field in neuron-monitor no longer supported 16 September 2024 en eos-neuron-device-version neuron-device-version This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting with Neuron release 2.20 , Neuron no longer supports the field ‘neuron-device-version’ in neuron-monitor. Read more ... Tensorflow-Neuron 1.x no longer supported 16 September 2024 en no-support-tensorflow-eos tf-versions-1-x-no-support This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting with Neuron release 2.20 , Neuron no longer supports Tensorflow-Neuron 1.x.
Current users of those versions are advised to migrate to latest tensorflow-neuron version 2.10.1. Please see TensorFlow Neuron for more details. Read more ... Neuron Runtime no longer supports Amazon Linux 2 (AL2) 16 September 2024 en end-support-al2 This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting from Neuron release 2.20 , the Neuron Runtime ( aws-neuronx-runtime-lib ) will no longer support Amazon Linux 2 (AL2). The Neuron Driver ( aws-neuronx-dkms ) is now the only Neuron package that supports Amazon Linux 2. Read more ... Announcing maintenance mode for torch-neuron 1.9 and 1.10 versions 16 September 2024 en announce-torch-neuron-eos torch-neuron This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting with Neuron release 2.20 , torch-neuron 1.9 and 1.10 versions will enter maintenance mode.
Future Neuron releases will not include support for torch-neuron 1.9 and 1.10 versions. Current users of torch-neuron 1.9 and 1.10 versions are advised to migrate to torch-neuron 1.13. Read more ... Announcing Name Change for Neuron Component 16 September 2024 en announce-nxdcore neuron-component-nxdcore This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting with Neuron release 2.20 , the name of the following Neuron component will change as follows: Read more ... Neuron support for MxNet enters maintenance mode 28 June 2024 en announce-mxnet-maintenance mxnet This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting with Neuron release 2.19 , Neuron support for MxNet ( mxnet-neuron ) is entering maintenance mode. Read more ... Announcing end of support for ‘neurondevice’ resource name in Neuron Device K8s plugin 28 June 2024 en announce-eos-neuron-device neuron-device This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.19 will be the last release to include resource name ‘neurondevice’. Read more ... Announcing end of support for ‘neuron-device-version’ field in neuron-monitor 28 June 2024 en announce-eos-neuron-device-version neuron-device-version This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.19 will be the last release to include the field ‘neuron-device-version’ in neuron-monitor. Read more ... Announcing end of support for Tensorflow-Neuron 1.x 28 June 2024 en announce-tensorflow-eos tf-versions-1-x This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.19 will be the last release to support Tensorflow-Neuron 1.x.
Future Neuron releases will not include support for Tensorflow-Neuron 1.x versions. Current users of those versions are advised to migrate to latest tensorflow-neuron version 2.10.1. Read more ... Announcing end of support for Probuf versions <= 3.19 for PyTorch NeuronX, NeuronX Distributed, and Transformers NeuronX libraries 28 June 2024 en announce-eos-probuf probuf This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.19 will be the last release that will include Probuf <= 3.19 support for PyTorch NeuronX, NeuronX Distributed, and Transformers NeuronX libraries. Future Neuron releases will not include Probuf <= 3.19 support for PyTorch NeuronX. Read more ... Announcing end of support for Neuron Runtime support of Amazon Linux 2 (AL2) 28 June 2024 en announce-eos-al2 al2 This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.19 will be the last release that will include Neuron Runtime support for Amazon Linux 2 . Future Neuron releases will not include Neuron Runtime support for Amazon Linux 2 . Read more ... Announcing end of support for Neuron virtual environments in AWS Deep Learning AMI (Amazon Linux 2) 24 April 2024 en announce-eos-dlamis-inf1 dlami-inf1 This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.18.2 will be the last release that will include support for the following virtual environments in AWS Deep Learning AMI (Amazon Linux 2): Read more ... Announcing end of support for Neuron Release 2.18.0 Deep Learning AMIs 24 April 2024 en announce-eos-dlami neuron-dlami This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 We are announcing end of support for Neuron release 2.18.0 Deep Learning AMIs. DLAMIs released between March 26,2024 (2024-03-26) and April 10, 2024 (2024-04-10) were shipped without the audit package. The following are the affected DLAMIs: Read more ... Tensorflow-Neuron 1.x enters maintenance mode 01 April 2024 en announce-tensorflow-maintenance tf-versions This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting with Neuron release 2.18 , Tensorflow-Neuron 1.x is entering maintenance mode. Future releases of Tensorflow-Neuron 1.x will address critical security issues only and we will gradually end support. Current users of those versions are advised to migrate to latest tensorflow-neuron version 2.10.1. Read more ... PyTorch NeuronX version 2.0 (Beta) no longer supported 02 February 2024 en eos-pt-two pt-two This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.17 no longer supports PyTorch NeuronX version 2.0 (Beta). Read more ... Announcing Name Change for Neuron Components 21 December 2023 en announce-name-change neuron-component This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting with Neuron release 2.16 , the name of the following Neuron components will change as follows: Read more ... Announcing deprecation for NeuronX Distributed Training Samples in Neuron Samples Repository 20 December 2023 en announce-moving-nxd-samples nxd-samples This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.16 will be the last release to include support for NeuronX Distributed Training Samples (Llama-2, GPT-NeoX 20B, and GPT-NeoX 6.9B) under the AWS Neuron Samples Github repository . Read more ... Announcing deprecation for Neuron Containers with Runtime 1.x 20 December 2023 en announce-deprecating-containers runtime-rtd This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.3 was the last release to support Neuron Runtime 1.x (neuron-rtd).
Current users of Neuron DLC/DLAMI with Neuron Runtime 1.x are required to update their image to support latest Neuron Runtime versions. For instructions, see the Setup Guide . Read more ... Announcing End of Support for PyTorch NeuronX version 2.0 (beta) 20 December 2023 en announce-eos-pt-two pt-versions-two This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.16 will be the last release that will include beta support for PyTorch NeuronX version 2.0 (beta). Future Neuron releases will not include support for PyTorch NeuronX version 2.0. Read more ... Announcing End of Support for PyTorch Neuron version 1.10 20 December 2023 en announce-eos-pt pt-versions This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.16 will be the last release that will include support for PyTorch Neuron version 1.10. Future Neuron releases will not include support for PyTorch Neuron version 1.10. Read more ... Announcing End of Support for nemo option-argument 26 October 2023 en announce-intent-deprecation-nemo-arg nemo-arg This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.15 will be the last release that will include support for nemo option-argument in the existing –distribution_strategy compiler option . Future releases will not include Neuron support for nemo option-argument.
Users are advised to migrate to the new llm-training option-argument. Read more ... Announcing End Of Support for OPT example in Transformers NeuronX 26 October 2023 en announce-intent-eos-opt opt This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.15 will be the last release that will include OPT example in Transformers NeuronX. Read more ... Announcing deprecation for --model-type=transformer-inference compiler flag 15 September 2023 en announce-deprecation transformer-flag This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting with Neuron release 2.14 , the --model-type=transformer-inference compiler flag is deprecated. Read more ... Announcing end of support for torch-neuron version 1.9 28 August 2023 en announce-eol torch-neuron This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Title underline too short. Read more ... AWS Neuron reference for Megatron-LM no longer supported 28 August 2023 en announce-eos trn1 trn1n This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.13 no longer includes support for AWS Neuron reference for Megatron-LM . Read more ... Announcing end of support for AWS Neuron reference for Megatron-LM 08 August 2023 en announce-eol trn1 trn1n This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.12 will be the last release that will include support for AWS Neuron reference for Megatron-LM . Future releases will not include Neuron support for Megatron-LM. Read more ... AWS Deep Learning AMIs now available with Neuron 2.12 version 26 July 2023 en dlami pytorch trn1 inf2 inf1 This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 We are happy to announce that the following Deep Learning AMIs are now available with latest Neuron Version 2.12. Read more ... Announcing end of support for Python 3.7 26 July 2023 en announce-eol python37 This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Title underline too short. Read more ... Announcing end of support for Ubuntu 18 13 July 2023 en announce-eol ubuntu18 This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.12 will be the last release that will include support for Ubuntu 18 . Future Neuron releases will not include support for Ubuntu 18 Read more ... AWS Deep Learning AMIs now available with Neuron 2.10 version 02 May 2023 en dlami pytorch trn1 inf2 inf1 This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 We are happy to announce that the following Deep Learning AMIs are now available with latest Neuron Version 2.10. These DLAMIs now support
all the Neuron EC2 instances including Inf1, Inf2, Trn1/Trn1n. Read more ... Announcing end of support for tensorflow-neuron versions 2.7 01 May 2023 en announce-eol tensorflow-neuron This document is relevant for : Inf1 Neuron release 2.10 will be the last release that will include tensorflow-neuron versions 2.7. Future Neuron releases will not include tensorflow-neuron versions 2.7 Read more ... Announcing end of support for mxnet-neuron versions 1.5 01 May 2023 en announce-eol mxnet-neuron This document is relevant for : Inf1 Neuron release 2.10 will be the last release that will include mxnet-neuron versions 1.5. Future Neuron releases will not include mxnet-neuron versions 1.5 Read more ... PyTorch 1.13 Deep Learning Container for Inf2 & Trn1/Trn1n now available for SageMaker 26 April 2023 en sagemaker pytorch trn1 inf2 This document is relevant for : Inf2 , Trn1 , Trn2 We are happy to announce that an updated Deep Learning Container that supports PyTorch 1.13 and Neuron 2.9.1 versions is now available for Sagemaker Training. Read more ... Introducing Neuron packaging and installation changes for Inf1 customers 22 November 2022 en neuron2.x This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting with Neuron release 2.5 , Neuron introduces changes in Neuron packages and installation instructions for Inf1, the following  Neuron packages will change names: Read more ... Announcing end of support for tensorflow-neuron versions 2.5 and 2.6 22 November 2022 en announce-eol tensorflow-neuron This document is relevant for : Inf1 Neuron release 2.5 will be the last release that will include tensorflow-neuron versions 2.5 and 2.6. Future Neuron releases will not include tensorflow-neuron versions 2.5 and 2.6. Read more ... Announcing end of support for torch-neuron versions 1.7 and 1.8 22 November 2022 en announce-eol torch-neuron This document is relevant for : Inf1 Neuron release 2.5 will be the last release that will include torch-neuron versions 1.7 and 1.8. Future Neuron releases will not include torch-neuron versions 1.7 and 1.8. Read more ... Neuron GPG key for Ubuntu installation has expired 10 November 2022 en dlami pytorch This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 GPG, or GNU Privacy Guard, is a public key cryptography implementation. This allows for the secure transmission of information between parties and can be used to verify that the origin of a message is genuine. Read more ... Amazon SageMaker now supports Trn1 training jobs 03 November 2022 en sagemaker pytorch trn1 This document is relevant for : Inf2 , Trn1 , Trn2 We are happy to announce that Amazon SageMaker now supports running training jobs on ml.trn1 instance types. Read more ... Introducing AWS Deep Learning AMI Neuron PyTorch 02 November 2022 en dlami pytorch This document is relevant for : Inf2 , Trn1 , Trn2 We are happy to announce that Deep Learning AMI (DLAMI) with pre-installed PyTorch Neuron ( torch-neuronx ) is now available, for more information see: Read more ... Introducing the first release of Neuron 2.x enabling EC2 Trn1 General Availability (GA) 10 October 2022 en neuron2.x This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Neuron release 2.3 is the first release of Neuron 2.x that enables GA of the new EC2 Trn1 instances.
Neuron release 2.3 extends the latest release of Neuron 1.x (Neuron 1.19.2), adding support for Deep Learning training on the AWS Trainium chips. Read more ... Introducing Packaging and installation changes 10 October 2022 en neuron2.x This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting with Neuron release 2.3 , Neuron introduces changes in Neuron packages and installation instructions. Read more ... Introducing New Neuron GitHub Repositories 10 October 2022 en github This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting with Neuron release 2.3 , Neuron Github repositories will be migrated
to the new AWS Neuron GitHub Organization . Read more ... Announcing Neuron Runtime 1.x (neuron-rtd) end-of-support 10 October 2022 en eol neuron2.x This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 Starting with Neuron release 2.3 , Neuron components like Neuron System Tools
and Neuron Driver will no longer support Neuron Runtime 1.x. Read more ... End of support for torch-neuron version 1.5 29 April 2022 en eol This document is relevant for : Inf1 Starting with Neuron 1.19.0 release, torch-neuron 1.5 will no longer be supported, and
no further releases of torch-neuron version 1.5 will be issued.  Current users of torch-neuron version 1.5 are advised to migrate to
latest torch-neuron version. Read more ... End of support for tensorflow-neuron versions 2.1, 2.2, 2.3 and 2.4 25 March 2022 en eol This document is relevant for : Inf1 Starting with Neuron 1.18.0 release, tensorflow-neuron versions 2.1, 2.2, 2.3 and 2.4 will no longer be supported, and
no further releases of tensorflow-neuron versions 2.1, 2.2, 2.3 and 2.4 will be issued.  Current users of those versions are advised to migrate to
latest tensorflow-neuron version. Read more ... Announcing end of support for torch-neuron version 1.5 starting with Neuron 1.19.0 release 25 March 2022 en announce-eol torch-neuron This document is relevant for : Inf1 Starting with Neuron 1.19.0 release, torch-neuron version 1.5 will no longer be supported. Last release of torch-neuron version 1.5 will be issued
as part of Neuron 1.18.0 release. Current users of those versions are advised to migrate to latest torch-neuron version. Read more ... Announcing end of support for NEURONCORE_GROUP_SIZES starting with Neuron 1.20.0 release 25 March 2022 en announce-eol This document is relevant for : Inf1 Starting with Neuron SDK 1.20.0, NEURONCORE_GROUP_SIZES environment variable will no longer be supported. Setting NEURONCORE_GROUP_SIZES environment variable will no longer affect applications behavior.
Current customers using NEURONCORE_GROUP_SIZES environment variable are advised to use NEURON_RT_VISIBLE_CORES environment variable  or NEURON_RT_NUM_CORES environment variable instead. Read more ... Previous Announcements 17 February 2022 en announcements This document is relevant for : Inf1 02/17/2022 - tensorflow-neuron versions 2.1, 2.2, 2.3 and 2.4 enter maintenance mode Read more ... By AWS © Copyright 2025, Amazon.com.

## https://github.com/orgs/aws-neuron/projects/1/views/1

AWS Neuron Roadmap · GitHub Skip to content Navigation Menu Toggle navigation Sign in Product GitHub Copilot Write better code with AI Security Find and fix vulnerabilities Actions Automate any workflow Codespaces Instant dev environments Issues Plan and track work Code Review Manage code changes Discussions Collaborate outside of code Code Search Find more, search less Explore All features Documentation GitHub Skills Blog Solutions By company size Enterprises Small and medium teams Startups Nonprofits By use case DevSecOps DevOps CI/CD View all use cases By industry Healthcare Financial services Manufacturing Government View all industries View all solutions Resources Topics AI DevOps Security Software Development View all Explore Learning Pathways Events & Webinars Ebooks & Whitepapers Customer Stories Partners Executive Insights Open Source GitHub Sponsors Fund open source developers The ReadME Project GitHub community articles Repositories Topics Trending Collections Enterprise Enterprise platform AI-powered developer platform Available add-ons Advanced Security Enterprise-grade security features Copilot for business Enterprise-grade AI features Premium Support Enterprise-grade 24/7 support Pricing Search or jump to... Search code, repositories, users, issues, pull requests... Search Clear Search syntax tips Provide feedback We read every piece of feedback, and take your input very seriously. Include my email address so I can be contacted Cancel Submit feedback Saved searches Use saved searches to filter your results more quickly Name Query To see all available qualifiers, see our documentation . Cancel Create saved search Sign in Sign up Reseting focus You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert You can’t perform that action at this time.

## https://github.com/aws-neuron/aws-neuron-samples/tree/master/tensorflow-neuron/inference

aws-neuron-samples/tensorflow-neuron/inference at master · aws-neuron/aws-neuron-samples · GitHub Skip to content Navigation Menu Toggle navigation Sign in Product GitHub Copilot Write better code with AI Security Find and fix vulnerabilities Actions Automate any workflow Codespaces Instant dev environments Issues Plan and track work Code Review Manage code changes Discussions Collaborate outside of code Code Search Find more, search less Explore All features Documentation GitHub Skills Blog Solutions By company size Enterprises Small and medium teams Startups Nonprofits By use case DevSecOps DevOps CI/CD View all use cases By industry Healthcare Financial services Manufacturing Government View all industries View all solutions Resources Topics AI DevOps Security Software Development View all Explore Learning Pathways Events & Webinars Ebooks & Whitepapers Customer Stories Partners Executive Insights Open Source GitHub Sponsors Fund open source developers The ReadME Project GitHub community articles Repositories Topics Trending Collections Enterprise Enterprise platform AI-powered developer platform Available add-ons Advanced Security Enterprise-grade security features Copilot for business Enterprise-grade AI features Premium Support Enterprise-grade 24/7 support Pricing Search or jump to... Search code, repositories, users, issues, pull requests... Search Clear Search syntax tips Provide feedback We read every piece of feedback, and take your input very seriously. Include my email address so I can be contacted Cancel Submit feedback Saved searches Use saved searches to filter your results more quickly Name Query To see all available qualifiers, see our documentation . Cancel Create saved search Sign in Sign up Reseting focus You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert aws-neuron / aws-neuron-samples Public Notifications You must be signed in to change notification settings Fork 38 Star 137 Code Issues 12 Pull requests 11 Actions Projects 0 Security Insights Additional navigation options Code Issues Pull requests Actions Projects Security Insights Files master Breadcrumbs aws-neuron-samples / tensorflow-neuron / inference / Copy path Directory actions More options Directory actions More options Latest commit History History master Breadcrumbs aws-neuron-samples / tensorflow-neuron / inference / Top Folders and files Name Name Last commit message Last commit date parent directory .. unet unet View all files Footer © 2025 GitHub, Inc. Footer navigation Terms Privacy Security Status Docs Contact Manage cookies Do not share my personal information You can’t perform that action at this time.

## https://github.com/aws-neuron/aws-neuron-sdk/edit/master/general/nki/api/nki.rst

Sign in to GitHub · GitHub Skip to content You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert Sign in to GitHub Username or email address Password Forgot password? Password login alternatives Sign in with a passkey New to GitHub? Create an account Terms Privacy Docs Contact GitHub Support Manage cookies Do not share my personal information You can’t perform that action at this time.

## https://awsdocs-neuron.readthedocs-hosted.com/en/latest/release-notes/index.html#latest-neuron-release

What’s New — AWS Neuron Documentation Skip to main content Ctrl + K Neuron 2.21.1 is released! check What's New and Announcements Ctrl + K Search Engine: Default Google Overview Quick Links Ask Q Developer Get Started with Neuron Samples and Tutorials Training on Trn1 Inference on Inf2 and Trn1 Inference on Inf1 Performance What’s New Announcements ML Frameworks PyTorch Neuron Pytorch Neuron Setup Inference (Inf2, Trn1, Trn2) Tutorials Compiling and Deploying HuggingFace Pretrained BERT on Trn1 or Inf2 BERT TorchServe Tutorial LibTorch C++ Tutorial Compiling and Deploying ResNet50 on Trn1 or Inf2 T5 model inference on Trn1 or Inf2 Additional Examples AWS Neuron Samples GitHub Repository Transformers Neuron GitHub samples API Reference Guide PyTorch NeuronX Tracing API for Inference PyTorch Neuron ( torch-neuronx ) Weight Replacement API for Inference PyTorch NeuronX NeuronCore Placement APIs [Beta] PyTorch NeuronX Analyze API for Inference PyTorch NeuronX DataParallel API Developer Guide NeuronCore Allocation and Model Placement for Inference ( torch-neuronx ) Comparison of Traced Inference versus XLA Lazy Tensor Inference ( torch-neuronx ) Data Parallel Inference on torch_neuronx Misc PyTorch Neuron ( torch-neuronx ) release notes Inference (Inf1) Tutorials Computer Vision Tutorials Natural Language Processing (NLP) Tutorials Utilizing Neuron Capabilities Tutorials Additional Examples AWS Neuron Samples GitHub Repository API Reference Guide PyTorch Neuron trace Python API torch.neuron.DataParallel API PyTorch Neuron ( torch-neuron ) Core Placement API [Beta] Developer Guide Running Inference on Variable Input Shapes with Bucketing Data Parallel Inference on PyTorch Neuron Developer Guide - PyTorch Neuron ( torch-neuron ) LSTM Support PyTorch Neuron ( torch-neuron ) Core Placement Misc PyTorch Neuron ( torch-neuron ) Supported operators Troubleshooting Guide for PyTorch Neuron ( torch-neuron ) PyTorch Neuron ( torch-neuron ) release notes Training Tutorials Hugging Face BERT Pretraining Tutorial (Data-Parallel) Multi-Layer Perceptron Training Tutorial PyTorch Neuron for Trainium Hugging Face BERT MRPC task finetuning using Hugging Face Trainer API Fine-tune T5 model on Trn1 ZeRO-1 Tutorial Analyze for Training Tutorial Neuron Custom C++ Operators in MLP Training Neuron Custom C++ Operators Performance Optimization Additional Examples AWS Neuron Reference for Nemo Megatron GitHub Repository AWS Neuron Samples for EKS AWS Neuron Samples for AWS ParallelCluster AWS Neuron Samples GitHub Repository API Reference Guide PyTorch NeuronX neuron_parallel_compile CLI PyTorch NeuronX Environment Variables Neuron Persistent Cache PyTorch NeuronX Profiling API Developer Guide Developer Guide for Training with PyTorch NeuronX How to debug models in PyTorch NeuronX Developer Guide for Profiling with PyTorch NeuronX Misc PyTorch Neuron ( torch-neuronx ) - Supported Operators How to prepare trn1.32xlarge for multi-node execution PyTorch Neuron ( torch-neuronx ) for Training Troubleshooting Guide PyTorch Neuron ( torch-neuronx ) release notes JAX Neuron JAX Neuron plugin Setup JAX Neuron Known issues TensorFlow Neuron Tensorflow Neuron Setup Inference (Inf2 & Trn1) Tutorials HuggingFace Roberta-Base Using NEURON_RT_VISIBLE_CORES with TensorFlow Serving API Reference Guide TensorFlow 2.x ( tensorflow-neuronx ) Tracing API TensorFlow 2.x ( tensorflow-neuronx ) Auto Multicore Replication (Beta) TensorFlow 2.x ( tensorflow-neuronx ) analyze_model API Misc TensorFlow 2.x ( tensorflow-neuronx ) Release Notes Inference (Inf1) Tutorials Natural Language Processing (NLP) Tutorials Utilizing Neuron Capabilities Tutorials Additional Examples AWS Neuron Samples GitHub Repository API Reference Guide TensorFlow 2.x ( tensorflow-neuron ) Tracing API TensorFlow 2.x ( tensorflow-neuron ) analyze_model API TensorFlow 2.x ( tensorflow-neuron ) Auto Multicore Replication (Beta) Misc TensorFlow 2.x ( tensorflow-neuron ) Release Notes TensorFlow 2.x ( tensorflow-neuron ) Accelerated ( torch-neuron ) Python APIs and Graph Ops NeuronX Distributed (NxD) NxD Training (Beta) Overview Setup App Notes Introducing NxD Training Tensor Parallelism Overview Pipeline Parallelism Overview Activation Memory Reduction API Reference Guide YAML Configuration Settings Developer Guides Integrating a new model Integrating a new dataset/dataloader Registering an optimizer and LR scheduler Migrating from Neuron-NeMo-Megatron to Neuronx Distributed Training NxD Training Compatibility with NeMo Tutorials Megatron GPT Pretraining HuggingFace Llama3-8B Pretraining HuggingFace LLama3-8B Supervised Fine-tuning HuggingFace Llama3-8B Direct Preference Optimization (DPO) based Fine-tuning HuggingFace Llama3-70B, Llama3.1-70B Pretraining Checkpoint Conversion Misc NxD Training Release Notes ( neuronx-distributed-training ) Known Issues and Workarounds NxD Inference (Beta) Overview NxD Inference Overview Setup API Reference Guide NxD Inference API Reference Developer Guides NxD Inference Features Configuration Guide NxD Inference - Production Ready Models Onboarding models to run on NxD Inference vLLM User Guide for NxD Inference Migrating from NxD Core inference examples to NxD Inference Migrating from Transformers NeuronX to  NeuronX Distributed(NxD) Inference LLM Inference Benchmarking guide Tutorials Tutorial: Deploying Llama3.1 405B (Trn2) Tutorial: Deploying Llama3.2 Multimodal Models Tutorial: Using Speculative Decoding to improve Llama-3.3-70B inference performance on Trn2 instances Tutorial: Using Speculative Decoding and Quantization to improve Llama-3.1-405B inference performance on Trn2 instances App Notes Introducing NeuronX Distributed (NxD) Inference Misc NxD Inference Release Notes ( neuronx-distributed-inference ) NxD Core Setup App Notes Tensor Parallelism Overview Pipeline Parallelism Overview Activation Memory Reduction API Reference Guide Distributed Strategies APIs Training APIs Inference APIs Developer Guide Training Developer Guides Developer guide for Tensor Parallelism Developer guide for Pipeline Parallelism Developer guide for Activation Memory reduction Developer guide for save/load checkpoint Developer guide for Neuron-PT-Lightning Developer guide for model and optimizer wrapper Developer guide for LoRA finetuning Inference Developer Guide Developer guide for Neuronx-Distributed  Inference Tutorials Training Tutorials Training using Tensor Parallelism Training GPT-NeoX 6.9B using TP and ZeRO-1 Training GPT-NeoX 20B using TP and ZeRO-1 Training Llama 3.1 8B/Llama 3 8B/Llama 2 7B using TP and ZeRO-1 Training Llama 3.1 70B/Llama 3 70B/Llama 2 13B/70B using TP and PP Training Llama-2-7B/13B/70B using TP and PP with PyTorch-Lightning Inference Tutorials T5 inference with Tensor Parallelism Llama-2-7b Inference Misc NxD Core Release Notes ( neuronx-distributed ) Additional ML Libraries Third Party Libraries Transformers Neuron Setup Developer Guide Transformers NeuronX ( transformers-neuronx ) Developer Guide Transformers NeuronX ( transformers-neuronx ) Developer Guide for Continuous Batching Tutorials Hugging Face meta-llama/Llama-2-13b autoregressive sampling on Inf2 & Trn1 Hugging Face facebook/opt-13b autoregressive sampling on Inf2 & Trn1 Hugging Face facebook/opt-30b autoregressive sampling on Inf2 & Trn1 Hugging Face facebook/opt-66b autoregressive sampling on Inf2 Misc Transformers Neuron ( transformers-neuronx ) release notes AWS Neuron reference for NeMo Megatron Developer Flows Neuron DLAMI Neuron Containers Getting started with Neuron DLC using Docker Neuron Deep Learning Containers Customize Neuron DLC Neuron Plugins for Containerized Environments Neuron Containers FAQ AWS Workload Orchestration Amazon EKS Using Neuron with Amazon EKS Deploy Neuron Container on Elastic Kubernetes Service (EKS) for Inference Deploy a simple mlp training script as a Kubernetes job Amazon ECS Neuron Problem Detector And Recovery Deploy Neuron Container on Elastic Container Service (ECS) for Inference Deploy Neuron Container on Elastic Container Service (ECS) for Training AWS ParallelCluster Parallel Cluster Flows- Training Train your model on ParallelCluster AWS Batch Train your model on AWS Batch Amazon SageMaker Third-party Solutions Setup Guide Launching Inf/Trn instances on Amazon EC2 Inference Compile with Framework API and Deploy on EC2 Inf1 Compile with Framework API and Deploy on EC2 Inf2 Training Train your model on EC2 PyTorch NeuronX (torch-neuronx) PyTorch Neuron (torch-neuron) JAX NeuronX JAX Neuron plugin Setup JAX Neuron Known issues Tensorflow NeuronX (tensorflow-neuronx) Tensorflow Neuron (tensorflow-neuron) MxNet Neuron (mxnet-neuron) Runtime & Tools Neuron Runtime API Reference Guide Runtime API Configuration Guide Runtime Configuration Misc Troubleshooting on Inf1 and Trn1 FAQ Neuron Runtime Release Notes Neuron Driver Release Notes Neuron Collectives Release Notes Monitoring Tools Neuron-Monitor User Guide Neuron-Top User Guide Neuron-LS User Guide Neuron-Sysfs User Guide NCCOM-TEST User Guide What's New Profiling Tools Neuron Profiler User Guide Neuron Profiler 2.0 (Beta) User Guide Neuron-DET User guide What's New Third-party Solutions Other Tools Check Model GatherInfo NeuronPerf Neuron Calculator TensorBoard Plugin for Neuron (Trn1) TensorBoard Plugin for Neuron (Inf1) Track Training Progress in TensorBoard using PyTorch Neuron TensorBoard What's New Compiler Neuron Compiler NeuronX Compiler for Trn1 & Inf2 API Reference Guide Neuron Compiler CLI Reference Guide Developer Guide Mixed Precision and Performance-accuracy Tuning ( neuronx-cc ) Misc FAQ What's New Neuron Compiler for Inf1 API Reference Guide Neuron compiler CLI Reference Guide ( neuron-cc ) Developer Guide Mixed precision and performance-accuracy tuning ( neuron-cc ) Misc FAQ What's New Neuron Supported operators Neuron Kernel Interface (Beta) API Reference Manual nki nki.jit nki.benchmark nki.baremetal nki.simulate_kernel nki.tensor nki.language nki.language.load nki.language.store nki.language.load_transpose2d nki.language.atomic_rmw nki.language.copy nki.language.ndarray nki.language.zeros nki.language.zeros_like nki.language.ones nki.language.full nki.language.rand nki.language.random_seed nki.language.shared_constant nki.language.shared_identity_matrix nki.language.add nki.language.subtract nki.language.multiply nki.language.divide nki.language.power nki.language.maximum nki.language.minimum nki.language.max nki.language.min nki.language.mean nki.language.var nki.language.sum nki.language.prod nki.language.all nki.language.abs nki.language.negative nki.language.sign nki.language.trunc nki.language.floor nki.language.ceil nki.language.exp nki.language.log nki.language.cos nki.language.sin nki.language.tan nki.language.tanh nki.language.arctan nki.language.sqrt nki.language.rsqrt nki.language.sigmoid nki.language.relu nki.language.gelu nki.language.gelu_dx nki.language.gelu_apprx_tanh nki.language.silu nki.language.silu_dx nki.language.erf nki.language.erf_dx nki.language.softplus nki.language.mish nki.language.square nki.language.softmax nki.language.rms_norm nki.language.dropout nki.language.matmul nki.language.transpose nki.language.bitwise_and nki.language.bitwise_or nki.language.bitwise_xor nki.language.invert nki.language.left_shift nki.language.right_shift nki.language.equal nki.language.not_equal nki.language.greater nki.language.greater_equal nki.language.less nki.language.less_equal nki.language.logical_and nki.language.logical_or nki.language.logical_xor nki.language.logical_not nki.language.ds nki.language.arange nki.language.mgrid nki.language.expand_dims nki.language.where nki.language.all_reduce nki.language.static_range nki.language.affine_range nki.language.sequential_range nki.language.par_dim nki.language.psum nki.language.sbuf nki.language.hbm nki.language.private_hbm nki.language.shared_hbm nki.language.program_id nki.language.num_programs nki.language.program_ndim nki.language.spmd_dim nki.language.nc nki.language.device_print nki.language.loop_reduce nki.language.tfloat32 nki.language.bfloat16 nki.language.float8_e4m3 nki.language.float8_e5m2 nki.language.tile_size nki.isa nki.isa.nc_matmul nki.isa.nc_transpose nki.isa.activation nki.isa.activation_reduce nki.isa.tensor_reduce nki.isa.tensor_partition_reduce nki.isa.tensor_tensor nki.isa.tensor_tensor_scan nki.isa.scalar_tensor_tensor nki.isa.tensor_scalar nki.isa.tensor_scalar_reduce nki.isa.tensor_copy nki.isa.tensor_copy_dynamic_src nki.isa.reciprocal nki.isa.iota nki.isa.dropout nki.isa.affine_select nki.isa.memset nki.isa.bn_stats nki.isa.bn_aggr nki.isa.local_gather nki.isa.dma_copy nki.isa.tensor_engine nki.isa.vector_engine nki.isa.scalar_engine nki.isa.gpsimd_engine nki.isa.dma_engine nki.isa.unknown_engine nki.isa.nc_version nki.isa.get_nc_version nki.compiler nki.compiler.sbuf.alloc nki.compiler.sbuf.mod_alloc nki.compiler.sbuf.auto_alloc nki.compiler.psum.alloc nki.compiler.psum.mod_alloc nki.compiler.psum.auto_alloc nki.compiler.skip_middle_end_transformations nki.compiler.enable_stack_allocator nki.compiler.force_auto_alloc NKI API Common Fields NKI API Errors Developer Guide Getting Started with NKI NKI Programming Model NKI Kernel as a Framework Custom Operator NeuronDevice Architecture Guide for NKI Trainium/Inferentia2 Architecture Guide for NKI Trainium2 Architecture Guide for NKI Profiling NKI kernels with Neuron Profile NKI Performance Guide NKI Direct Allocation Developer Guide Tutorials Single program, multiple data tensor addition Single program, multiple data tensor addition using multiple Neuron Cores Transpose2D AveragePool2D Matrix multiplication RMSNorm LayerNorm Fused Self Attention Fused Mamba Kernels nki.kernels.fused_self_attn_for_SD_small_head_size nki.kernels.allocated_fused_self_attn_for_SD_small_head_size nki.kernels.allocated_fused_rms_norm_qkv nki.kernels.flash_attn_bwd nki.kernels.resize_nearest_fixed_dma_kernel nki.kernels.flash_fwd nki.kernels.select_and_scatter_kernel Misc NKI FAQ What's New NKI Known Issues Neuron C++ Custom Operators API Reference Guide Custom Operators API Reference Guide [Beta] Developer Guide Neuron Custom C++ Operators Developer Guide [Beta] Tutorials Neuron Custom C++ Operators in MLP Training Neuron Custom C++ Operators Performance Optimization Misc (Neuron Custom C++ Operators) Neuron Custom C++ Tools Release Notes Neuron Custom C++ Library Release Notes Learning Neuron Architecture Trn/Inf Instances Amazon EC2 AI Chips NeuronCores Features Data types Rounding modes Neuron batching NeuronCore pipeline Neuron persistent cache Collective communication Logical NeuronCore configuration Custom C++ operators Application notes Introducing the first release of Neuron 2.x enabling EC2 Trn1 General Availability (GA) Introducing Neuron Runtime 2.x (libnrt.so) Performance Tuning Parallel Execution using NEURON_RT_NUM_CORES Running R-CNNs on Inf1 Graph Partitioner on torch_neuronx Generative LLM inference with Neuron Introducing PyTorch 2.5 Support FAQ Troubleshooting Neuron Glossary Legacy Software Apache MXNet MXNet Neuron Setup Inference (Inf1) Tutorials Computer Vision Tutorials Natural Language Processing (NLP) Tutorials Utilizing Neuron Capabilities Tutorials API Reference Guide Neuron Apache MXNet Compilation Python API Developer Guide Flexible Execution Group (FlexEG) in Neuron-MXNet Misc Troubleshooting Guide for Neuron Apache MXNet What's New Neuron Apache MXNet Supported operators About Neuron Release Details Roadmap Neuron Public Roadmap Support SDK Maintenance Policy Security Disclosures Contact Us Repository Suggest edit Open issue .rst .pdf What’s New Contents Neuron 2.21.1 (01/14/2025) Neuron 2.21.0 (12/20/2024) What’s New 2.21.0 Known Issues and Limitations Neuron 2.21.0 Beta (12/03/2024) Release Artifacts Trn2 packages Trn1 packages Inf2 packages Inf1 packages Supported Python Versions for Inf1 packages Supported Python Versions for Inf2/Trn1/Trn2 packages Supported Numpy Versions Supported HuggingFace Transformers Versions Previous Releases This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 What’s New # Table of contents Neuron 2.21.1 (01/14/2025) Neuron 2.21.0 (12/20/2024) Neuron 2.21.0 Beta (12/03/2024) Release Artifacts Previous Releases Neuron 2.21.1 (01/14/2025) # Neuron 2.21.1 release pins Transformers NeuronX dependency to transformers<4.48 and fixes DMA abort errors on Trn2. Additionally, this release addresses NxD Core and Training improvements, including fixes for sequence parallel support in quantized models and a new flag for dtype control in Llama3/3.1 70B configurations. See NxD Training Release Notes (neuronx-distributed-training) for details. NxD Inference update includes minor bug fixes for sampling parameters. See NxD Inference Release Notes . Neuron supported DLAMIs and DLCs have been updated to Neuron 2.21.1 SDK. Users should be aware of an incompatibility between Tensorflow-Neuron 2.10 (Inf1) and Neuron Runtime 2.21 in DLAMIs, which will be addressed in the next minor release. See Neuron DLAMI Release Notes . The Neuron Compiler includes bug fixes and performance enhancements specifically targeting the Trn2 platform. Neuron 2.21.0 (12/20/2024) # Table of contents What’s New 2.21.0 Known Issues and Limitations What’s New # Overview : Neuron 2.21.0 introduces support for AWS Trainium2 and Trn2 instances , including the trn2.48xlarge instance type and Trn2
UltraServer (Preview). The release adds new capabilities in both training and
inference of large-scale models. It introduces NxD Inference (beta) , a
PyTorch-based library for deployment, Neuron Profiler 2.0 (beta) , and PyTorch 2.5 support across the Neuron SDK, and Logical NeuronCore
Configuration (LNC) for optimizing NeuronCore allocation. The release
enables Llama 3.1 405B model inference on a single trn2.48xlarge
instance. NxD Inference : NxD Inference (beta) is a new PyTorch-based inference library for
deploying large-scale models on AWS Inferentia and Trainium instances.
It enables PyTorch model onboarding with minimal code changes and
integrates with vLLM . NxDI supports various model architectures,
including Llama versions for text processing (Llama 2, Llama 3, Llama
3.1, Llama 3.2, and Llama 3.3), Llama 3.2 multimodal for multimodal
tasks , and Mixture-of-Experts (MoE) model architectures including
Mixtral and DBRX. The library supports quantization methods, includes
dynamic sampling, and is compatible with HuggingFace checkpoints and
generate() API. NxDI also supports distributed strategies including tensor parallelism and incorporates speculative decoding techniques (Draft model and EAGLE). The
release includes Llama 3.1 405B model sample , Llama 3.3 70B model sample and Llama 3.1 405B model with speculative decoding for inference on a single trn2.48xlarge instance. For more information, see NxD Inference documentation and check the NxD
Inference Github repository: aws-neuron/neuronx-distributed-inference Transformers NeuronX (TNx) : This release introduces several new features, including flash decoding support for speculative decoding, and on-device generation in speculative decoding flows. It adds Eagle speculative decoding with greedy and lossless sampling, as well as support for CPU compilation and sharded model saving. Performance improvements include optimized MLP and QKV for Llama models with sequence parallel norm and control over concurrent compilation workers. Training Highlights: NxD Training in this release adds support for
HuggingFace Llama3/3.1 70B on trn2 instances, introduces DPO support for
post-training model alignment, and adds support for Mixture-of-Experts
(MoE) models including Mixtral 7B. The release includes improved checkpoint conversion capabilities and supports MoE with Tensor,
Sequence, Pipeline, and Expert parallelism. ML Frameworks: Neuron 2.21.0 adds support for PyTorch 2.5 and
JAX 0.4.35. Note The CVEs CVE-2024-31583 and CVE-2024-31580 affect PyTorch versions 2.1 and earlier. Based on Amazon’s analysis,
executing models on Trainium and Inferentia is not exposed to either of
these vulnerabilities. We recommend upgrading to the new version of
Torch-NeuronX by following the Neuron setup instructions. Logical NeuronCore Configuration (LNC) : This release introduces LNC for Trainium2 instances, optimizing NeuronCore allocation for ML
applications. LNC offers two configurations: default (LNC=2) combining
two physical cores, and alternative (LNC=1) mapping each physical core
individually. This feature allows users to efficiently manage resources
for large-scale model training and deployment through runtime variables
and compiler flags. Neuron Profiler 2.0: The new profiler provides system and
device-level profiling, timeline annotations, container integration, and
support for distributed workloads. It includes trace export capabilities
for Perfetto visualization and integration with JAX and PyTorch
profilers, and support for Logical NeuronCore
Configuration (LNC) . Neuron Kernel Interface (NKI) : NKI now supports Trainium2 including Logical NeuronCore Configuration (LNC) , adds SPMD capabilities for
multi-core operations, and includes new modules and APIs including
support for float8_e5m2 datatype. Deep Learning Containers (DLAMIs) : This release expands support for
JAX 0.4 within the Multi Framework DLAMI . It also introduces NxD Training, NxD Inference, and NxD Core with PyTorch 2.5 support. Additionally, a new Single Framework DLAMI for
TensorFlow 2.10 on Ubuntu 22 is now available. Deep Learning Containers (DLCs): This release introduces new DLCs
for JAX 0.4 training and PyTorch 2.5.1 inference and training. All DLCs
have been updated to Ubuntu 22, and the pytorch-inference-neuronx DLC
now supports both NxD Inference and TNx libraries. Documentation : Documentation updates include architectural details
about Trainium2 and NeuronCore-v3 , along with specifications and
topology information for the trn2.48xlarge instance type and Trn2
UltraServer. Software Maintenance : This release includes the following announcements : Announcing migration of NxD Core examples from NxD Core repository to NxD Inference repository in next release Announcing end of support for Neuron DET tool starting next release PyTorch Neuron versions 1.9 and 1.10 no longer supported Announcing end of support for PyTorch 2.1 for Trn1, Trn2 and Inf2 starting next release Announcing end of support for PyTorch 1.13 for Trn1 and Inf2 starting next release Announcing end of support for Python 3.8 in future releases Announcing end of support for Ubuntu20 DLCs and DLAMIs Amazon Q : Use Q Developer as your Neuron Expert for general technical guidance and to jumpstart your NKI kernel development. More release content can be found in the table below and each component release notes. What’s New Details Instances Known Issues and Limitations See 2.21.0 Known Issues and Limitations Trn1/Trn1n , Inf2, Inf1 Transformers NeuronX (transformers-neuronx) for Inference Flash decoding support for speculative decoding Added support for EAGLE speculative decoding with greedy and lossless sampling Enabled on-device generation support in speculative decoding flows See more at Transformers Neuron (transformers-neuronx) release notes Inf2, Trn1/Trn1n, Trn2 NxD Core (neuronx-distributed) Training: Added support for HuggingFace Llama3 70B with Trn2 instances Added DPO support for post-training model alignment See more at NxD Core Release Notes (neuronx-distributed) Trn1/Trn1n,Trn2 NxD Inference (neuronx-distributed-inference) Introduced new NxD Inference Library. See Introducing NeuronX Distributed (NxD) Inference Added Llama3.1 405B Inference Example on Trn2. See Tutorial: Deploying Llama3.1 405B (Trn2) Added Llama 3.2 Multimodal inference sample. See Tutorial: Deploying Llama3.2 Multimodal Models Added support for vLLM integration for NxD Inference. See vLLM User Guide for NxD Inference Introduced Open Source Github repository for NxD Inference. See aws-neuron/neuronx-distributed-inference See more at NxD Inference Release Notes (neuronx-distributed-inference) Inf2, Trn1/Trn1n,Trn2 NxD Training (neuronx-distributed-training) Added support for HuggingFace Llama3/3.1 70B with Trn2 instances Added support for Mixtral 8x7B Megatron and HuggingFace models Added support for custom pipeline parallel cuts in HuggingFace Llama3 Added support for DPO post-training model alignment See more at NxD Training Release Notes (neuronx-distributed-training) Trn1/Trn1n,Trn2 PyTorch NeuronX (torch-neuronx) Introduced PyTorch 2.5 support See more at PyTorch Neuron (torch-neuronx) release notes Trn1/Trn1n,Inf2,Trn2 NeuronX Nemo Megatron for Training Added support for HuggingFace to NeMo checkpoint conversion when virtual pipeline parallel is enabled. Added collective compute coalescing for ZeRO-1 optimizer See more at neuronx-nemo-megatron github repo and AWS Neuron Reference for Nemo Megatron(neuronx-nemo-megatron) Release Notes Trn1/Trn1n,Inf2 Neuron Compiler (neuronx-cc) Minor bug fixes and performance enhancements for the Trn2 platform. See more at Neuron Compiler (neuronx-cc) release notes Trn1/Trn1n,Inf2,Trn2 Neuron Kernel Interface (NKI) Added api/nki.compiler module with Allocation Control and Kernel decorators Added new nki.isa APIs. See api/nki.isa Added new nki.language APIs. See api/nki.language Added new kernels ( allocated_fused_self_attn_for_SD_small_head_size , allocated_fused_rms_norm_qkv ). See api/nki.kernels See more at Neuron Kernel Interface (NKI) release notes Trn1/Trn1n,Inf2 Neuron Deep Learning AMIs (DLAMIs) Added support for Trainium2 chips within the Neuron Multi Framework DLAMI. Added support for JAX 0.4 to Neuron Multi Framework DLAMI. Added NxD Training (NxDT), NxD Inference (NxDI) and NxD Core PyTorch 2.5 support within the Neuron Multi Framework DLAMI. See more at Neuron DLAMI User Guide Inf1,Inf2,Trn1/Trn1n Neuron Deep Learning Containers (DLCs) Added new pytorch-inference-neuronx 2.5.1 and pytorch-training-neuronx 2.5.1 DLCs Added new jax-training-neuronx 0.4 Training DLC See more at Neuron DLC Release Notes Inf1,Inf2,Trn1/Trn1n Neuron Tools Introduced Neuron Profiler 2.0. See Neuron Profiler 2.0 (Beta) User Guide See more at Neuron System Tools Inf1,Inf2,Trn1/Trn1n,Trn2 Neuron Runtime Added runtime support to fail in case of out-of-bound memory access when DGE is enabled. Added support for 4-rank replica group on adjacent Neuron cores on TRN1/TRN1N See more at Neuron Runtime Release Notes Inf1,Inf2,Trn1/Trn1n,Trn2 Release Annoucements Announcing end of support for Neuron DET tool starting next release Announcing migration of NxD Core examples from NxD Core repository to NxD Inference repository in next release Announcing end of support for Python 3.8 in future releases Announcing end of support for PyTorch 1.13 starting next release Announcing end of support for PyTorch 2.1 starting next release Announcing end of support for Ubuntu20 DLCs and DLAMIs PyTorch Neuron versions 1.9 and 1.10 no longer supported See more at Announcements Inf1, Inf2, Trn1/Trn1n Documentation Updates See Neuron Documentation Release Notes Inf1, Inf2, Trn1/Trn1n, Trn2 Minor enhancements and bug fixes. See components-rn Trn1/Trn1n , Inf2, Inf1, Trn2 Release Artifacts see Release Artifacts Trn1/Trn1n , Inf2, Inf1, Trn2 2.21.0 Known Issues and Limitations # See component release notes below for any additional known issues. Neuron 2.21.0 Beta (12/03/2024) # Note This release (Neuron 2.21 Beta) was only tested with Trn2 instances. The next release (Neuron 2.21) will support all instances (Inf1, Inf2, Trn1, and Trn2). For access to this release (Neuron 2.21 Beta), please contact your account manager. This release (Neuron 2.21 beta) introduces support for AWS Trainium2 and Trn2 instances , including the trn2.48xlarge instance type and Trn2 UltraServer. The release showcases Llama 3.1 405B model inference using NxD Inference on a single trn2.48xlarge instance, and FUJI 70B model training using the AXLearn library across eight trn2.48xlarge instances. NxD Inference , a new PyTorch-based library for deploying large language models and multi-modality models, is introduced in this release. It integrates with vLLM and enables PyTorch model onboarding with minimal code changes. The release also adds support for AXLearn training for JAX models. The new Neuron Profiler 2.0 introduced in this release offers system and device-level profiling, timeline annotations, and container integration. The profiler supports distributed workloads and provides trace export capabilities for Perfetto visualization. The documentation has been updated to include architectural details about Trainium2 and NeuronCore-v3 , along with specifications and topology information for the trn2.48xlarge instance type and Trn2 UltraServer. Use Q Developer as your Neuron Expert for general technical guidance and to jumpstart your NKI kernel development. Note For the latest release that supports Trn1, Inf2 and Inf1 instances, please see Neuron Release 2.20.2 Release Artifacts # Table of contents Trn2 packages Trn1 packages Inf2 packages Inf1 packages Supported Python Versions for Inf1 packages Supported Python Versions for Inf2/Trn1/Trn2 packages Supported Numpy Versions Supported HuggingFace Transformers Versions Trn2 packages # List of packages in Neuron 2.21.1:

Component                           Package                                           
Collective Communication Library    aws-neuronx-collectives-2.23.135.0 
Driver                              aws-neuronx-dkms-2.19.64.0 
nan                                 aws-neuronx-gpsimd-customop-lib-0.13.16.0 
CustomOps Tools                     aws-neuronx-gpsimd-tools-0.13.2.0 
Kubernetes Plugin                   aws-neuronx-k8-plugin-2.23.45.0 
Kubernetes Scheduler                aws-neuronx-k8-scheduler-2.23.45.0 
OCI                                 aws-neuronx-oci-hook-2.6.36.0 
General                             aws-neuronx-runtime-discovery-2.9 
Runtime Library                     aws-neuronx-runtime-lib-2.23.112.0 
System Tools                        aws-neuronx-tools-2.20.204.0 
Compiler                            neuronx-cc-2.16.372.0 
Compiler                            neuronx-cc-stubs-2.16.372.0 
Neuron Distributed                  neuronx_distributed-0.10.1 
Neuron Distributed Inference        neuronx_distributed_inference-0.1.1 
PyTorch                             torch-neuronx-2.1.2.2.4.0 
PyTorch                             torch-neuronx-2.5.1.2.4.0 
PyTorch                             torch_xla-2.1.6 Trn1 packages # List of packages in Neuron 2.21.1:

Component                           Package                                           
Collective Communication Library    aws-neuronx-collectives-2.23.135.0 
Driver                              aws-neuronx-dkms-2.19.64.0 
nan                                 aws-neuronx-gpsimd-customop-lib-0.13.16.0 
CustomOps Tools                     aws-neuronx-gpsimd-tools-0.13.2.0 
Kubernetes Plugin                   aws-neuronx-k8-plugin-2.23.45.0 
Kubernetes Scheduler                aws-neuronx-k8-scheduler-2.23.45.0 
OCI                                 aws-neuronx-oci-hook-2.6.36.0 
General                             aws-neuronx-runtime-discovery-2.9 
Runtime Library                     aws-neuronx-runtime-lib-2.23.112.0 
System Tools                        aws-neuronx-tools-2.20.204.0 
Jax                                 jax_neuronx-0.1.2 
Framework                           libneuronxla-2.1.714.0 
Framework                           libneuronxla-0.5.3396 
Compiler                            neuronx-cc-2.16.372.0 
Compiler                            neuronx-cc-stubs-2.16.372.0 
Neuron Distributed                  neuronx_distributed-0.10.1 
Neuron Distributed Training         neuronx_distributed_training-1.1.1 
TensorBoard                         tensorboard-plugin-neuronx-2.6.52.0 
TensorFlow Model Server             tensorflow-model-server-neuronx-2.10.1.2.12.2.0 
TensorFlow Model Server             tensorflow-model-server-neuronx-2.9.3.2.12.2.0 
TensorFlow Model Server             tensorflow-model-server-neuronx-2.8.4.2.12.2.0 
TensorFlow                          tensorflow-neuronx-2.10.1.2.1.0 
TensorFlow                          tensorflow-neuronx-2.8.4.2.1.0 
TensorFlow                          tensorflow-neuronx-2.9.3.2.1.0 
PyTorch                             torch-neuronx-1.13.1.1.17.0 
PyTorch                             torch-neuronx-2.1.2.2.4.0 
PyTorch                             torch-neuronx-2.5.1.2.4.0 
PyTorch                             torch_xla-1.13.1+torchneurong 
PyTorch                             torch_xla-2.1.6 
Transformers Neuron                 transformers-neuronx-0.13.380 Inf2 packages # List of packages in Neuron 2.21.1:

Component                           Package                                           
Collective Communication Library    aws-neuronx-collectives-2.23.135.0 
Driver                              aws-neuronx-dkms-2.19.64.0 
nan                                 aws-neuronx-gpsimd-customop-lib-0.13.16.0 
CustomOps Tools                     aws-neuronx-gpsimd-tools-0.13.2.0 
Kubernetes Plugin                   aws-neuronx-k8-plugin-2.23.45.0 
Kubernetes Scheduler                aws-neuronx-k8-scheduler-2.23.45.0 
OCI                                 aws-neuronx-oci-hook-2.6.36.0 
General                             aws-neuronx-runtime-discovery-2.9 
Runtime Library                     aws-neuronx-runtime-lib-2.23.112.0 
System Tools                        aws-neuronx-tools-2.20.204.0 
Jax                                 jax_neuronx-0.1.2 
Framework                           libneuronxla-2.1.714.0 
Framework                           libneuronxla-0.5.3396 
Compiler                            neuronx-cc-2.16.372.0 
Compiler                            neuronx-cc-stubs-2.16.372.0 
Neuron Distributed                  neuronx_distributed-0.10.1 
Neuron Distributed Inference        neuronx_distributed_inference-0.1.1 
TensorBoard                         tensorboard-plugin-neuronx-2.6.52.0 
TensorFlow Model Server             tensorflow-model-server-neuronx-2.10.1.2.12.2.0 
TensorFlow Model Server             tensorflow-model-server-neuronx-2.9.3.2.12.2.0 
TensorFlow Model Server             tensorflow-model-server-neuronx-2.8.4.2.12.2.0 
TensorFlow                          tensorflow-neuronx-2.10.1.2.1.0 
TensorFlow                          tensorflow-neuronx-2.8.4.2.1.0 
TensorFlow                          tensorflow-neuronx-2.9.3.2.1.0 
PyTorch                             torch-neuronx-1.13.1.1.17.0 
PyTorch                             torch-neuronx-2.1.2.2.4.0 
PyTorch                             torch-neuronx-2.5.1.2.4.0 
PyTorch                             torch_xla-1.13.1+torchneurong 
PyTorch                             torch_xla-2.1.6 
Transformers Neuron                 transformers-neuronx-0.13.380 Inf1 packages # List of packages in Neuron 2.21.1:

Component                           Package                                           
Collective Communication Library    aws-neuronx-collectives-2.12.35.0 
Driver                              aws-neuronx-dkms-2.19.64.0 
Kubernetes Plugin                   aws-neuronx-k8-plugin-2.23.45.0 
Kubernetes Scheduler                aws-neuronx-k8-scheduler-2.23.45.0 
OCI                                 aws-neuronx-oci-hook-2.6.36.0 
Runtime Library                     aws-neuronx-runtime-lib-2.12.23.0 
System Tools                        aws-neuronx-tools-2.20.204.0 
Compiler                            dmlc_nnvm-1.19.6.0 
Compiler                            dmlc_topi-1.19.6.0 
Compiler                            dmlc_tvm-1.19.6.0 
Compiler                            inferentia_hwm-1.17.6.0 
MXNet                               mx_neuron-1.8.0.2.4.147.0 
MXNet                               mxnet_neuron-1.5.1.1.10.0.0 
Compiler                            neuron-cc-1.24.0.0 
Perf Tools                          neuronperf-1.8.93.0 
TensorFlow Model Server             tensorflow-model-server-neuronx-2.10.1.2.12.2.0 
TensorFlow Model Server             tensorflow-model-server-neuronx-2.9.3.2.12.2.0 
TensorFlow Model Server             tensorflow-model-server-neuronx-2.8.4.2.12.2.0 
TensorFlow                          tensorflow-neuron-2.10.1.2.12.2.0 
TensorFlow                          tensorflow-neuron-2.8.4.2.12.2.0 
TensorFlow                          tensorflow-neuron-2.9.3.2.12.2.0 
PyTorch                             torch-neuron-1.10.2.2.11.13.0 
PyTorch                             torch-neuron-1.11.0.2.11.13.0 
PyTorch                             torch-neuron-1.12.1.2.11.13.0 
PyTorch                             torch-neuron-1.13.1.2.11.13.0 Supported Python Versions for Inf1 packages # List of packages in Neuron 2.21.1:

Package                                        Supported Python Versions              
dmlc_nnvm-1.19.6.0                                3.8, 3.9, 3.10 
dmlc_topi-1.19.6.0                                3.8, 3.9, 3.10 
dmlc_tvm-1.19.6.0                                 3.8, 3.9, 3.10 
inferentia_hwm-1.17.6.0                           3.8, 3.9, 3.10 
mx_neuron-1.8.0.2.4.147.0                         3.8, 3.9, 3.10 
mxnet_neuron-1.5.1.1.10.0.0                       3.8, 3.9, 3.10 
neuron-cc-1.24.0.0                                3.8, 3.9, 3.10 
neuronperf-1.8.93.0                               3.8, 3.9, 3.10 
tensorflow-neuron-2.10.1.2.12.2.0                 3.8, 3.9, 3.10 
tensorflow-neuron-2.8.4.2.12.2.0                  3.8, 3.9, 3.10 
tensorflow-neuron-2.9.3.2.12.2.0                  3.8, 3.9, 3.10 
torch-neuron-1.10.2.2.11.13.0                     3.8, 3.9, 3.10 
torch-neuron-1.11.0.2.11.13.0                     3.8, 3.9, 3.10 
torch-neuron-1.12.1.2.11.13.0                     3.8, 3.9, 3.10 
torch-neuron-1.13.1.2.11.13.0                     3.8, 3.9, 3.10 Supported Python Versions for Inf2/Trn1/Trn2 packages # List of packages in Neuron 2.21.1:

Package                                        Supported Python Versions              
aws-neuronx-runtime-discovery-2.9                 3.8, 3.9, 3.10, 3.11 
jax_neuronx-0.1.2                                 3.9 
libneuronxla-2.1.714.0                            3.8, 3.9, 3.10, 3.11 
libneuronxla-0.5.3396                             3.8, 3.9, 3.10 
neuronx-cc-2.16.372.0                             3.8, 3.9, 3.10, 3.11 
neuronx-cc-stubs-2.16.372.0                       3.8, 3.9, 3.10 
neuronx_distributed-0.10.1                        3.8, 3.9, 3.10, 3.11 
neuronx_distributed_inference-0.1.1               3.8, 3.9, 3.10, 3.11 
tensorflow-neuronx-2.10.1.2.1.0                   3.8, 3.9, 3.10 
tensorflow-neuronx-2.8.4.2.1.0                    3.8, 3.9, 3.10 
tensorflow-neuronx-2.9.3.2.1.0                    3.8, 3.9, 3.10 
torch-neuronx-1.13.1.1.17.0                       3.8, 3.9, 3.10, 3.11 
torch-neuronx-2.1.2.2.4.0                         3.8, 3.9, 3.10, 3.11 
torch-neuronx-2.5.1.2.4.0                         3.8, 3.9, 3.10, 3.11 
torch_xla-1.13.1+torchneurong                     3.8, 3.9, 3.10, 3.11 
torch_xla-2.1.6                                   3.8, 3.9, 3.10, 3.11 
transformers-neuronx-0.13.380                     3.8, 3.9, 3.10, 3.11 Supported Numpy Versions # Neuron supports versions >= 1.21.6 and <= 1.22.2 Supported HuggingFace Transformers Versions # Package Supported HuggingFace
Transformers Versions torch-neuronx < 4.35 and >=4.37.2 transformers-neuronx >= 4.36.0 neuronx-distributed - Llama
model class 4.31 neuronx-distributed - GPT NeoX
model class 4.26 neuronx-distributed - Bert model
class 4.26 nemo-megatron 4.31.0 Previous Releases # Previous Releases Notes (Neuron 2.x) Previous Releases Artifacts (Neuron 2.x) Previous Release Notes (Neuron 1.x) This document is relevant for : Inf1 , Inf2 , Trn1 , Trn2 previous Neuron performance next Announcements Contents Neuron 2.21.1 (01/14/2025) Neuron 2.21.0 (12/20/2024) What’s New 2.21.0 Known Issues and Limitations Neuron 2.21.0 Beta (12/03/2024) Release Artifacts Trn2 packages Trn1 packages Inf2 packages Inf1 packages Supported Python Versions for Inf1 packages Supported Python Versions for Inf2/Trn1/Trn2 packages Supported Numpy Versions Supported HuggingFace Transformers Versions Previous Releases By AWS © Copyright 2025, Amazon.com.

## https://github.com/aws-neuron/aws-neuron-samples/blob/master/torch-neuronx/transformers-neuronx/inference/meta-llama-2-13b-sampling.ipynb

aws-neuron-samples/torch-neuronx/transformers-neuronx/inference/meta-llama-2-13b-sampling.ipynb at master · aws-neuron/aws-neuron-samples · GitHub Skip to content Navigation Menu Toggle navigation Sign in Product GitHub Copilot Write better code with AI Security Find and fix vulnerabilities Actions Automate any workflow Codespaces Instant dev environments Issues Plan and track work Code Review Manage code changes Discussions Collaborate outside of code Code Search Find more, search less Explore All features Documentation GitHub Skills Blog Solutions By company size Enterprises Small and medium teams Startups Nonprofits By use case DevSecOps DevOps CI/CD View all use cases By industry Healthcare Financial services Manufacturing Government View all industries View all solutions Resources Topics AI DevOps Security Software Development View all Explore Learning Pathways Events & Webinars Ebooks & Whitepapers Customer Stories Partners Executive Insights Open Source GitHub Sponsors Fund open source developers The ReadME Project GitHub community articles Repositories Topics Trending Collections Enterprise Enterprise platform AI-powered developer platform Available add-ons Advanced Security Enterprise-grade security features Copilot for business Enterprise-grade AI features Premium Support Enterprise-grade 24/7 support Pricing Search or jump to... Search code, repositories, users, issues, pull requests... Search Clear Search syntax tips Provide feedback We read every piece of feedback, and take your input very seriously. Include my email address so I can be contacted Cancel Submit feedback Saved searches Use saved searches to filter your results more quickly Name Query To see all available qualifiers, see our documentation . Cancel Create saved search Sign in Sign up Reseting focus You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert aws-neuron / aws-neuron-samples Public Notifications You must be signed in to change notification settings Fork 38 Star 137 Code Issues 12 Pull requests 11 Actions Projects 0 Security Insights Additional navigation options Code Issues Pull requests Actions Projects Security Insights Files master Breadcrumbs aws-neuron-samples / torch-neuronx / transformers-neuronx / inference / meta-llama-2-13b-sampling.ipynb Copy path Blame Blame Latest commit History History 244 lines (244 loc) · 10.5 KB master Breadcrumbs aws-neuron-samples / torch-neuronx / transformers-neuronx / inference / meta-llama-2-13b-sampling.ipynb Top File metadata and controls Preview Code Blame 244 lines (244 loc) · 10.5 KB Raw Loading Viewer requires iframe. Footer © 2025 GitHub, Inc. Footer navigation Terms Privacy Security Status Docs Contact Manage cookies Do not share my personal information You can’t perform that action at this time.

## https://github.com/aws-neuron/aws-neuron-samples/blob/master/torch-neuronx/transformers-neuronx/inference/facebook-opt-30b-sampling.ipynb

aws-neuron-samples/torch-neuronx/transformers-neuronx/inference/facebook-opt-30b-sampling.ipynb at master · aws-neuron/aws-neuron-samples · GitHub Skip to content Navigation Menu Toggle navigation Sign in Product GitHub Copilot Write better code with AI Security Find and fix vulnerabilities Actions Automate any workflow Codespaces Instant dev environments Issues Plan and track work Code Review Manage code changes Discussions Collaborate outside of code Code Search Find more, search less Explore All features Documentation GitHub Skills Blog Solutions By company size Enterprises Small and medium teams Startups Nonprofits By use case DevSecOps DevOps CI/CD View all use cases By industry Healthcare Financial services Manufacturing Government View all industries View all solutions Resources Topics AI DevOps Security Software Development View all Explore Learning Pathways Events & Webinars Ebooks & Whitepapers Customer Stories Partners Executive Insights Open Source GitHub Sponsors Fund open source developers The ReadME Project GitHub community articles Repositories Topics Trending Collections Enterprise Enterprise platform AI-powered developer platform Available add-ons Advanced Security Enterprise-grade security features Copilot for business Enterprise-grade AI features Premium Support Enterprise-grade 24/7 support Pricing Search or jump to... Search code, repositories, users, issues, pull requests... Search Clear Search syntax tips Provide feedback We read every piece of feedback, and take your input very seriously. Include my email address so I can be contacted Cancel Submit feedback Saved searches Use saved searches to filter your results more quickly Name Query To see all available qualifiers, see our documentation . Cancel Create saved search Sign in Sign up Reseting focus You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert aws-neuron / aws-neuron-samples Public Notifications You must be signed in to change notification settings Fork 38 Star 137 Code Issues 12 Pull requests 11 Actions Projects 0 Security Insights Additional navigation options Code Issues Pull requests Actions Projects Security Insights Files master Breadcrumbs aws-neuron-samples / torch-neuronx / transformers-neuronx / inference / facebook-opt-30b-sampling.ipynb Copy path Blame Blame Latest commit History History 259 lines (259 loc) · 12.4 KB master Breadcrumbs aws-neuron-samples / torch-neuronx / transformers-neuronx / inference / facebook-opt-30b-sampling.ipynb Top File metadata and controls Preview Code Blame 259 lines (259 loc) · 12.4 KB Raw Loading Viewer requires iframe. Footer © 2025 GitHub, Inc. Footer navigation Terms Privacy Security Status Docs Contact Manage cookies Do not share my personal information You can’t perform that action at this time.

## https://github.com/aws-neuron/aws-neuron-sdk/issues/new?title=Issue%20on%20page%20%2Fgeneral/nki/api/nki.html&body=Your%20issue%20content%20here.

Sign in to GitHub · GitHub Skip to content You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert Sign in to GitHub Username or email address Password Forgot password? Password login alternatives Sign in with a passkey New to GitHub? Create an account Terms Privacy Docs Contact GitHub Support Manage cookies Do not share my personal information You can’t perform that action at this time.

## https://github.com/aws-neuron/aws-neuron-samples/blob/master/torch-neuronx/transformers-neuronx/inference/facebook-opt-13b-sampling.ipynb

aws-neuron-samples/torch-neuronx/transformers-neuronx/inference/facebook-opt-13b-sampling.ipynb at master · aws-neuron/aws-neuron-samples · GitHub Skip to content Navigation Menu Toggle navigation Sign in Product GitHub Copilot Write better code with AI Security Find and fix vulnerabilities Actions Automate any workflow Codespaces Instant dev environments Issues Plan and track work Code Review Manage code changes Discussions Collaborate outside of code Code Search Find more, search less Explore All features Documentation GitHub Skills Blog Solutions By company size Enterprises Small and medium teams Startups Nonprofits By use case DevSecOps DevOps CI/CD View all use cases By industry Healthcare Financial services Manufacturing Government View all industries View all solutions Resources Topics AI DevOps Security Software Development View all Explore Learning Pathways Events & Webinars Ebooks & Whitepapers Customer Stories Partners Executive Insights Open Source GitHub Sponsors Fund open source developers The ReadME Project GitHub community articles Repositories Topics Trending Collections Enterprise Enterprise platform AI-powered developer platform Available add-ons Advanced Security Enterprise-grade security features Copilot for business Enterprise-grade AI features Premium Support Enterprise-grade 24/7 support Pricing Search or jump to... Search code, repositories, users, issues, pull requests... Search Clear Search syntax tips Provide feedback We read every piece of feedback, and take your input very seriously. Include my email address so I can be contacted Cancel Submit feedback Saved searches Use saved searches to filter your results more quickly Name Query To see all available qualifiers, see our documentation . Cancel Create saved search Sign in Sign up Reseting focus You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert aws-neuron / aws-neuron-samples Public Notifications You must be signed in to change notification settings Fork 38 Star 137 Code Issues 12 Pull requests 11 Actions Projects 0 Security Insights Additional navigation options Code Issues Pull requests Actions Projects Security Insights Files master Breadcrumbs aws-neuron-samples / torch-neuronx / transformers-neuronx / inference / facebook-opt-13b-sampling.ipynb Copy path Blame Blame Latest commit History History 254 lines (254 loc) · 12.4 KB master Breadcrumbs aws-neuron-samples / torch-neuronx / transformers-neuronx / inference / facebook-opt-13b-sampling.ipynb Top File metadata and controls Preview Code Blame 254 lines (254 loc) · 12.4 KB Raw Loading Viewer requires iframe. Footer © 2025 GitHub, Inc. Footer navigation Terms Privacy Security Status Docs Contact Manage cookies Do not share my personal information You can’t perform that action at this time.

## https://github.com/aws-neuron/aws-neuron-eks-samples

GitHub - aws-neuron/aws-neuron-eks-samples Skip to content Navigation Menu Toggle navigation Sign in Product GitHub Copilot Write better code with AI Security Find and fix vulnerabilities Actions Automate any workflow Codespaces Instant dev environments Issues Plan and track work Code Review Manage code changes Discussions Collaborate outside of code Code Search Find more, search less Explore All features Documentation GitHub Skills Blog Solutions By company size Enterprises Small and medium teams Startups Nonprofits By use case DevSecOps DevOps CI/CD View all use cases By industry Healthcare Financial services Manufacturing Government View all industries View all solutions Resources Topics AI DevOps Security Software Development View all Explore Learning Pathways Events & Webinars Ebooks & Whitepapers Customer Stories Partners Executive Insights Open Source GitHub Sponsors Fund open source developers The ReadME Project GitHub community articles Repositories Topics Trending Collections Enterprise Enterprise platform AI-powered developer platform Available add-ons Advanced Security Enterprise-grade security features Copilot for business Enterprise-grade AI features Premium Support Enterprise-grade 24/7 support Pricing Search or jump to... Search code, repositories, users, issues, pull requests... Search Clear Search syntax tips Provide feedback We read every piece of feedback, and take your input very seriously. Include my email address so I can be contacted Cancel Submit feedback Saved searches Use saved searches to filter your results more quickly Name Query To see all available qualifiers, see our documentation . Cancel Create saved search Sign in Sign up Reseting focus You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert aws-neuron / aws-neuron-eks-samples Public Notifications You must be signed in to change notification settings Fork 7 Star 21 License MIT-0 license 21 stars 7 forks Branches Tags Activity Star Notifications You must be signed in to change notification settings Code Issues 1 Pull requests 2 Actions Projects 0 Security Insights Additional navigation options Code Issues Pull requests Actions Projects Security Insights aws-neuron/aws-neuron-eks-samples master Branches Tags Go to file Code Folders and files Name Name Last commit message Last commit date Latest commit History 67 Commits dp_bert_hf_pretrain dp_bert_hf_pretrain llama3.1_8B_finetune_ray_ptl_neuron llama3.1_8B_finetune_ray_ptl_neuron mlp_train mlp_train sd_hf_serve sd_hf_serve .gitignore .gitignore CODEOWNERS CODEOWNERS CODE_OF_CONDUCT.md CODE_OF_CONDUCT.md CONTRIBUTING.md CONTRIBUTING.md LICENSE LICENSE NOTICE NOTICE README.md README.md releasenotes.md releasenotes.md View all files Repository files navigation README Code of conduct MIT-0 license Security AWS Neuron EKS Samples This repository contains samples for Amazon Elastic Kubernetes Service (EKS) and AWS Neuron , the software development kit (SDK) that enables machine learning (ML) inference and training workloads on the AWS ML accelerator chips Inferentia and Trainium . The samples in this repository demonstrate the types of patterns that can be used to deliver inference and distributed training on EKS using Inferentia and Trainium. The samples can be used as-is, or easily modified to support additional models and use cases. Samples are organized by use case below: Training Link Description Instance Type BERT pretraining End-end workflow for creating an EKS cluster with 2 trn1.32xl nodes and running BERT phase1 pretraining (64-worker DataParallel) Trn1 MLP training Introductory workflow for creating an EKS cluster with 1 node and running a simple MLP training job Trn1 Llama 3.1 8B finetuning with Ray+PTL End-end workflow for creating a Ray cluster with 2 trn1.32xlarge nodes on EKS and running Llama 3.1 8B finetuning Trn1 Inference Link Description Instance Type SD inference SD Inference workflow for creating an inference endpoint forwarded by ALB LoadBalancer powered by Karpenter's NodePool Inf2 Getting Help If you encounter issues with any of the samples in this repository, please open an issue via the GitHub Issues feature. Contributing Please refer to the CONTRIBUTING document for details on contributing additional samples to this repository. Release Notes Please refer to the Change Log . About No description, website, or topics provided. Resources Readme License MIT-0 license Code of conduct Code of conduct Security policy Security policy Activity Custom properties Stars 21 stars Watchers 32 watching Forks 7 forks Report repository Releases No releases published Packages 0 No packages published Contributors 11 Languages Python 82.1% Shell 12.3% TypeScript 4.7% Other 0.9% Footer © 2025 GitHub, Inc. Footer navigation Terms Privacy Security Status Docs Contact Manage cookies Do not share my personal information You can’t perform that action at this time.

## https://github.com/aws-neuron/aws-neuron-samples/tree/master/torch-neuronx/training

aws-neuron-samples/torch-neuronx/training at master · aws-neuron/aws-neuron-samples · GitHub Skip to content Navigation Menu Toggle navigation Sign in Product GitHub Copilot Write better code with AI Security Find and fix vulnerabilities Actions Automate any workflow Codespaces Instant dev environments Issues Plan and track work Code Review Manage code changes Discussions Collaborate outside of code Code Search Find more, search less Explore All features Documentation GitHub Skills Blog Solutions By company size Enterprises Small and medium teams Startups Nonprofits By use case DevSecOps DevOps CI/CD View all use cases By industry Healthcare Financial services Manufacturing Government View all industries View all solutions Resources Topics AI DevOps Security Software Development View all Explore Learning Pathways Events & Webinars Ebooks & Whitepapers Customer Stories Partners Executive Insights Open Source GitHub Sponsors Fund open source developers The ReadME Project GitHub community articles Repositories Topics Trending Collections Enterprise Enterprise platform AI-powered developer platform Available add-ons Advanced Security Enterprise-grade security features Copilot for business Enterprise-grade AI features Premium Support Enterprise-grade 24/7 support Pricing Search or jump to... Search code, repositories, users, issues, pull requests... Search Clear Search syntax tips Provide feedback We read every piece of feedback, and take your input very seriously. Include my email address so I can be contacted Cancel Submit feedback Saved searches Use saved searches to filter your results more quickly Name Query To see all available qualifiers, see our documentation . Cancel Create saved search Sign in Sign up Reseting focus You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert aws-neuron / aws-neuron-samples Public Notifications You must be signed in to change notification settings Fork 38 Star 137 Code Issues 12 Pull requests 11 Actions Projects 0 Security Insights Additional navigation options Code Issues Pull requests Actions Projects Security Insights Files master Breadcrumbs aws-neuron-samples / torch-neuronx / training / Copy path Directory actions More options Directory actions More options Latest commit History History master Breadcrumbs aws-neuron-samples / torch-neuronx / training / Top Folders and files Name Name Last commit message Last commit date parent directory .. aws-batch aws-batch common common customop_mlp customop_mlp dp_bert_hf_pretrain dp_bert_hf_pretrain hf_bert_jp hf_bert_jp hf_contrastive_image_text hf_contrastive_image_text hf_image_classification hf_image_classification hf_language_modeling/ gpt2 hf_language_modeling/ gpt2 hf_sentiment_analysis hf_sentiment_analysis hf_summarization hf_summarization hf_text_classification hf_text_classification llama2 llama2 mnist_mlp mnist_mlp resnet50 resnet50 stable_diffusion stable_diffusion tp_dp_bert_hf_pretrain tp_dp_bert_hf_pretrain tp_dp_gpt_neox_hf_pretrain/ common tp_dp_gpt_neox_hf_pretrain/ common unet_image_segmentation unet_image_segmentation zero1_gpt2 zero1_gpt2 View all files Footer © 2025 GitHub, Inc. Footer navigation Terms Privacy Security Status Docs Contact Manage cookies Do not share my personal information You can’t perform that action at this time.

## https://github.com/aws-neuron/aws-neuron-samples/tree/master/torch-neuronx/

aws-neuron-samples/torch-neuronx at master · aws-neuron/aws-neuron-samples · GitHub Skip to content Navigation Menu Toggle navigation Sign in Product GitHub Copilot Write better code with AI Security Find and fix vulnerabilities Actions Automate any workflow Codespaces Instant dev environments Issues Plan and track work Code Review Manage code changes Discussions Collaborate outside of code Code Search Find more, search less Explore All features Documentation GitHub Skills Blog Solutions By company size Enterprises Small and medium teams Startups Nonprofits By use case DevSecOps DevOps CI/CD View all use cases By industry Healthcare Financial services Manufacturing Government View all industries View all solutions Resources Topics AI DevOps Security Software Development View all Explore Learning Pathways Events & Webinars Ebooks & Whitepapers Customer Stories Partners Executive Insights Open Source GitHub Sponsors Fund open source developers The ReadME Project GitHub community articles Repositories Topics Trending Collections Enterprise Enterprise platform AI-powered developer platform Available add-ons Advanced Security Enterprise-grade security features Copilot for business Enterprise-grade AI features Premium Support Enterprise-grade 24/7 support Pricing Search or jump to... Search code, repositories, users, issues, pull requests... Search Clear Search syntax tips Provide feedback We read every piece of feedback, and take your input very seriously. Include my email address so I can be contacted Cancel Submit feedback Saved searches Use saved searches to filter your results more quickly Name Query To see all available qualifiers, see our documentation . Cancel Create saved search Sign in Sign up Reseting focus You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert aws-neuron / aws-neuron-samples Public Notifications You must be signed in to change notification settings Fork 38 Star 137 Code Issues 12 Pull requests 11 Actions Projects 0 Security Insights Additional navigation options Code Issues Pull requests Actions Projects Security Insights Files master Breadcrumbs aws-neuron-samples / torch-neuronx / Copy path Directory actions More options Directory actions More options Latest commit History History master Breadcrumbs aws-neuron-samples / torch-neuronx / Top Folders and files Name Name Last commit message Last commit date parent directory .. inference inference microbenchmark microbenchmark training training transformers-neuronx transformers-neuronx README.md README.md View all files README.md PyTorch Neuron (torch-neuronx) Samples for AWS Trn1/Trn1n & Inf2 Instances This directory contains sample PyTorch Neuron inference and training scripts that can be run on AWS Trainium (Trn1/Trn1n instances) and AWS Inferentia (Inf2 instances). For additional information on these training scripts, please refer to the tutorials found in the official Trainium documentation . Training The following samples are available for training: Name Description Training Parallelism dp_bert_hf_pretrain Phase1 and phase2 pretraining of Hugging Face BERT-large model DataParallel mnist_mlp Examples of training a multilayer perceptron on the MNIST dataset DataParallel mnist_mlp Examples of training a multilayer perceptron on the MNIST dataset using DDP DataParallel hf_text_classification Fine-tuning various Hugging Face models for a text classification task DataParallel hf_image_classification Fine-tuning Hugging Face models (ex. ViT) for a image classification task DataParallel hf_contrastive_image_text Fine-tuning Multi-modal Image and Text Hugging Face models (ex. CLIP) DataParallel hf_language_modeling Training Hugging Face models (ex. GPT2) for causal language modeling (CLM) DataParallel hf_bert_jp Fine-tuning & Deployment Hugging Face BERT Japanese model DataParallel hf_sentiment_analysis Examples of training Hugging Face bert-base-cased model for a text classification task with Trn1 Single Neuron and Distributed Training DataParallel customop_mlp Examples of training a multilayer perceptron model with a custom Relu operator on a single Trn1 DataParallel tp_dp_gpt_neox_20b_hf_pretrain Training GPT-NEOX 20B model using neuronx-distributed Tensor Parallel & DataParallel tp_dp_gpt_neox_6.9b_hf_pretrain Training GPT-NEOX 6.9B model using neuronx-distributed Tensor Parallel & DataParallel tp_zero1_llama2_7b_hf_pretrain Training Llama-2 7B model using neuronx-distributed Tensor Parallel tp_pp_llama2_70b_hf_pretrain Training Llama-2 70B model using neuronx-distributed Tensor Parallel & Pipeline Parallel Inference The following samples are available for inference: Model Name Model Task Original Model Source BERT Base Uncased Masked language modeling and next sentence prediction bert-base-uncased DistilBERT Base Uncased Masked language modeling and next sentence prediction distilbert-base-uncased RoBERTa Large Masked language modeling, sequence classification, and question and answering roberta-large Vision Transformer (ViT) Image classification google/vit-base-patch16-224 GPT2 Text feature extraction gpt2 ResNet50 Image classification resnet50 HuggingFace Stable Diffusion 1.5 (512x512) Text to image generation stable-diffusion-v1-5 HuggingFace Stable Diffusion 2.1 (512x512) Text to image generation stable-diffusion-2-1-base HuggingFace Stable Diffusion 2.1 (768x768) Text to image generation stable-diffusion-2-1 HuggingFace Stable Diffusion XL Base 1.0 (1024x1024) Text to image generation stable-diffusion-xl-base-1.0 HuggingFace Stable Diffusion XL Base & Refiner 1.0 (1024x1024) Text to image generation stable-diffusion-xl-base-1.0 UNet Image Segmentation unet VGG Image Classification vgg Multimodal Perceiver Video Classification and Autoencoding multimodal-perceiver Language Perceiver Text Classification language-perceiver Vision Perceiver Image Classification vision-perceiver-conv CLIP Base Image Classification clip-vit-base-patch32 CLIP Large Image Classification clip-vit-large-patch14 Wav2Vec2 Conformer with Rotary Position Embeddings Automatic Speech Recognition facebook/wav2vec2-conformer-rope-large-960h-ft Wav2Vec2 Conformer with Relative Position Embeddings Automatic Speech Recognition facebook/wav2vec2-conformer-rel-pos-large-960h-ft The following samples are available for LLM tensor parallel inference: Name Instance type facebook/opt-13b Inf2 & Trn1 facebook/opt-30b Inf2 & Trn1 facebook/opt-66b Inf2 meta-llama/Llama-2-13b Inf2 & Trn1 Microbenchmarking The following samples are available for microbenchmarking: Name Description tutorial Microbenchmarking tutorial matmult Matrix multiplication microbenchmark Footer © 2025 GitHub, Inc. Footer navigation Terms Privacy Security Status Docs Contact Manage cookies Do not share my personal information You can’t perform that action at this time.

## https://github.com/aws-neuron/aws-neuron-sdk

GitHub - aws-neuron/aws-neuron-sdk: Powering AWS purpose-built machine learning chips. Blazing fast and cost effective, natively integrated into PyTorch and TensorFlow and integrated with your favorite AWS services Skip to content Navigation Menu Toggle navigation Sign in Product GitHub Copilot Write better code with AI Security Find and fix vulnerabilities Actions Automate any workflow Codespaces Instant dev environments Issues Plan and track work Code Review Manage code changes Discussions Collaborate outside of code Code Search Find more, search less Explore All features Documentation GitHub Skills Blog Solutions By company size Enterprises Small and medium teams Startups Nonprofits By use case DevSecOps DevOps CI/CD View all use cases By industry Healthcare Financial services Manufacturing Government View all industries View all solutions Resources Topics AI DevOps Security Software Development View all Explore Learning Pathways Events & Webinars Ebooks & Whitepapers Customer Stories Partners Executive Insights Open Source GitHub Sponsors Fund open source developers The ReadME Project GitHub community articles Repositories Topics Trending Collections Enterprise Enterprise platform AI-powered developer platform Available add-ons Advanced Security Enterprise-grade security features Copilot for business Enterprise-grade AI features Premium Support Enterprise-grade 24/7 support Pricing Search or jump to... Search code, repositories, users, issues, pull requests... Search Clear Search syntax tips Provide feedback We read every piece of feedback, and take your input very seriously. Include my email address so I can be contacted Cancel Submit feedback Saved searches Use saved searches to filter your results more quickly Name Query To see all available qualifiers, see our documentation . Cancel Create saved search Sign in Sign up Reseting focus You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert aws-neuron / aws-neuron-sdk Public Notifications You must be signed in to change notification settings Fork 159 Star 499 Powering AWS purpose-built machine learning chips. Blazing fast and cost effective, natively integrated into PyTorch and TensorFlow and integrated with your favorite AWS services aws.amazon.com/machine-learning/neuron/ License Unknown and 2 other licenses found Licenses found Unknown LICENSE-DOCUMENTATION MIT-0 LICENSE-SAMPLECODE Unknown LICENSE-SUMMARY-DOCS-SAMPLES 499 stars 159 forks Branches Tags Activity Star Notifications You must be signed in to change notification settings Code Issues 196 Pull requests 19 Actions Projects 1 Security Insights Additional navigation options Code Issues Pull requests Actions Projects Security Insights aws-neuron/aws-neuron-sdk master Branches Tags Go to file Code Folders and files Name Name Last commit message Last commit date Latest commit History 963 Commits .github .github _ext _ext _static/ css _static/ css _templates _templates compiler compiler containers containers dlami dlami frameworks frameworks general general images images info info libraries libraries neuron-customops neuron-customops neuron-runtime neuron-runtime release-notes release-notes src src static static tools tools .gitignore .gitignore .readthedocs.yml .readthedocs.yml CODEOWNERS CODEOWNERS CONTRIBUTING.md CONTRIBUTING.md LICENSE-DOCUMENTATION LICENSE-DOCUMENTATION LICENSE-SAMPLECODE LICENSE-SAMPLECODE LICENSE-SUMMARY-DOCS-SAMPLES LICENSE-SUMMARY-DOCS-SAMPLES Makefile Makefile README.md README.md conf.py conf.py index.rst index.rst inference-features-support.rst inference-features-support.rst requirements-python310.txt requirements-python310.txt requirements-python38.txt requirements-python38.txt requirements.txt requirements.txt View all files Repository files navigation README Code of conduct License MIT-0 license License Security AWS Neuron Neuron SDK Overview AWS Neuron is a software development kit (SDK) enabling high-performance deep learning acceleration using AWS Inferentia and Trainium, AWS's custom designed machine learning accelerators. With Neuron, you can develop, profile, and deploy high-performance machine learning workloads on top of accelerated EC2 instances, e.g. Inf1 and Trn1. Neuron includes a compiler, runtime driver, as well as debug and profiling utilities with a TensorBoard plugin for visualization, and is pre-integrated into popular machine learning frameworks like Pytorch, TensorFlow and MXNet, to provide a seamless machine learning acceleration workflow. Neuron SDK’s documentation For full documentations including user guide, Howtos and Tutorials see Neuron SDK’s documentation Support If none of the github and online resources have an answer to your question, checkout the AWS Neuron support forum . About Powering AWS purpose-built machine learning chips. Blazing fast and cost effective, natively integrated into PyTorch and TensorFlow and integrated with your favorite AWS services aws.amazon.com/machine-learning/neuron/ Resources Readme License Unknown and 2 other licenses found Licenses found Unknown LICENSE-DOCUMENTATION MIT-0 LICENSE-SAMPLECODE Unknown LICENSE-SUMMARY-DOCS-SAMPLES Code of conduct Code of conduct Security policy Security policy Activity Custom properties Stars 499 stars Watchers 79 watching Forks 159 forks Report repository Releases 72 Neuron SDK Release - January 14, 2025 Latest Jan 15, 2025 + 71 releases Packages 0 No packages published Contributors 121 + 107 contributors Languages Python 69.7% Jupyter Notebook 25.8% C 2.0% Shell 1.2% C++ 0.9% HTML 0.4% Footer © 2025 GitHub, Inc. Footer navigation Terms Privacy Security Status Docs Contact Manage cookies Do not share my personal information You can’t perform that action at this time.

## https://github.com/aws-neuron/aws-neuron-samples/tree/master/torch-neuronx/transformers-neuronx

aws-neuron-samples/torch-neuronx/transformers-neuronx at master · aws-neuron/aws-neuron-samples · GitHub Skip to content Navigation Menu Toggle navigation Sign in Product GitHub Copilot Write better code with AI Security Find and fix vulnerabilities Actions Automate any workflow Codespaces Instant dev environments Issues Plan and track work Code Review Manage code changes Discussions Collaborate outside of code Code Search Find more, search less Explore All features Documentation GitHub Skills Blog Solutions By company size Enterprises Small and medium teams Startups Nonprofits By use case DevSecOps DevOps CI/CD View all use cases By industry Healthcare Financial services Manufacturing Government View all industries View all solutions Resources Topics AI DevOps Security Software Development View all Explore Learning Pathways Events & Webinars Ebooks & Whitepapers Customer Stories Partners Executive Insights Open Source GitHub Sponsors Fund open source developers The ReadME Project GitHub community articles Repositories Topics Trending Collections Enterprise Enterprise platform AI-powered developer platform Available add-ons Advanced Security Enterprise-grade security features Copilot for business Enterprise-grade AI features Premium Support Enterprise-grade 24/7 support Pricing Search or jump to... Search code, repositories, users, issues, pull requests... Search Clear Search syntax tips Provide feedback We read every piece of feedback, and take your input very seriously. Include my email address so I can be contacted Cancel Submit feedback Saved searches Use saved searches to filter your results more quickly Name Query To see all available qualifiers, see our documentation . Cancel Create saved search Sign in Sign up Reseting focus You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert aws-neuron / aws-neuron-samples Public Notifications You must be signed in to change notification settings Fork 38 Star 137 Code Issues 12 Pull requests 11 Actions Projects 0 Security Insights Additional navigation options Code Issues Pull requests Actions Projects Security Insights Files master Breadcrumbs aws-neuron-samples / torch-neuronx / transformers-neuronx / Copy path Directory actions More options Directory actions More options Latest commit History History master Breadcrumbs aws-neuron-samples / torch-neuronx / transformers-neuronx / Top Folders and files Name Name Last commit message Last commit date parent directory .. inference inference README.md README.md View all files README.md PyTorch Neuron (transformers-neuronx) Samples for AWS Inf2 & Trn1 This directory contains sample Jupyter Notebooks demonstrating tensor parallel inference for various PyTorch large language models (LLMs) on AWS Inferentia (Inf2) instances) and AWS Trainium (Trn1) instances. For additional information on these training scripts, please refer to the tutorials found in the official Inferentia and Trainium documentation . Inference The following samples are available for LLM tensor parallel inference: Name Instance type facebook/opt-13b Inf2 & Trn1 facebook/opt-30b Inf2 & Trn1 facebook/opt-66b Inf2 meta-llama/Llama-2-13b Inf2 & Trn1 Footer © 2025 GitHub, Inc. Footer navigation Terms Privacy Security Status Docs Contact Manage cookies Do not share my personal information You can’t perform that action at this time.

## https://github.com/aws-neuron/aws-neuron-parallelcluster-samples

GitHub - aws-neuron/aws-neuron-parallelcluster-samples Skip to content Navigation Menu Toggle navigation Sign in Product GitHub Copilot Write better code with AI Security Find and fix vulnerabilities Actions Automate any workflow Codespaces Instant dev environments Issues Plan and track work Code Review Manage code changes Discussions Collaborate outside of code Code Search Find more, search less Explore All features Documentation GitHub Skills Blog Solutions By company size Enterprises Small and medium teams Startups Nonprofits By use case DevSecOps DevOps CI/CD View all use cases By industry Healthcare Financial services Manufacturing Government View all industries View all solutions Resources Topics AI DevOps Security Software Development View all Explore Learning Pathways Events & Webinars Ebooks & Whitepapers Customer Stories Partners Executive Insights Open Source GitHub Sponsors Fund open source developers The ReadME Project GitHub community articles Repositories Topics Trending Collections Enterprise Enterprise platform AI-powered developer platform Available add-ons Advanced Security Enterprise-grade security features Copilot for business Enterprise-grade AI features Premium Support Enterprise-grade 24/7 support Pricing Search or jump to... Search code, repositories, users, issues, pull requests... Search Clear Search syntax tips Provide feedback We read every piece of feedback, and take your input very seriously. Include my email address so I can be contacted Cancel Submit feedback Saved searches Use saved searches to filter your results more quickly Name Query To see all available qualifiers, see our documentation . Cancel Create saved search Sign in Sign up Reseting focus You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert aws-neuron / aws-neuron-parallelcluster-samples Public Notifications You must be signed in to change notification settings Fork 6 Star 23 License View license 23 stars 6 forks Branches Tags Activity Star Notifications You must be signed in to change notification settings Code Issues 3 Pull requests 2 Actions Projects 0 Security Insights Additional navigation options Code Issues Pull requests Actions Projects Security Insights aws-neuron/aws-neuron-parallelcluster-samples master Branches Tags Go to file Code Folders and files Name Name Last commit message Last commit date Latest commit History 112 Commits examples examples CODEOWNERS CODEOWNERS CODE_OF_CONDUCT.md CODE_OF_CONDUCT.md CONTRIBUTING.md CONTRIBUTING.md LICENSE LICENSE NOTICE NOTICE README.md README.md install_neuron.sh install_neuron.sh releasenotes.md releasenotes.md View all files Repository files navigation README Code of conduct License Security Train a model on AWS Trn1 ParallelCluster Introduction This document explains how to use AWS ParallelCluster to build HPC compute cluster that uses trn1 compute nodes to run your distributed ML training job. Once the nodes are launched, we will run a training task to confirm that the nodes are working, and use SLURM commands to check the job status. In this tutorial, we will use AWS pcluster command to run a YAML file in order to generate the cluster. As an example, we are going to launch multiple trn1.32xl nodes in our cluster. We are going to set up our ParallelCluster infrastructure as below: As shown in the figure above, inside a VPC, there are two subnets, a public and a private ones. Head node resides in the public subnet, while the compute fleet (in this case, trn1 instances) are in the private subnet. A Network Address Translation (NAT) gateway is also needed in order for nodes in the private subnet to connect to clients outside the VPC. In the next section, we are going to describe how to set up all the necessary infrastructure for Trn1 ParallelCluster. Prerequisite infrastructure VPC Creation A ParallelCluster requires a VPC that has two subnets and a Network Address Translation (NAT) gateway as shown in the diagram above. Here are the instructions to create the VPC and enable auto-assign public IPv4 address for the public subnet. Key pair A key pair is needed for access to the head node of the cluster. You may use an existing one or create a new key pair by following the instruction here AWS ParallelCluster Python package AWS ParallelCluster Python package is needed in a local environment (i.e., your Mac/PC desktop with a CLI terminal or an AWS Cloud9) where you issue the command to launch the creation process for your HPC environment in AWS. See here for instructions about installing AWS ParallelCluster Python package in your local environment. Create a cluster See table below for script to create trn1 ParallelCluster: Cluster Link 16xTrn1 nodes trn1-16-nodes-pcluster.md Launch training job See table below for script to launch a model training job on the ParallelCluster: Job Link BERT Large dp-bert-launch-job.md GPT3 (neuronx-nemo-megatron) neuronx-nemo-megatron-gpt-job.md Llama 2 7B (neuronx-nemo-megatron) neuronx-nemo-megatron-llamav2-job.md Launch training job [End of Support] See table below for scripts that are no longer supported: Job Link GPT3 (Megatron-LM) gpt3-launch-job.md Security See CONTRIBUTING for more information. License This library is licensed under the Amazon Software License. Release Notes Please refer to the Change Log . About No description, website, or topics provided. Resources Readme License View license Code of conduct Code of conduct Security policy Security policy Activity Custom properties Stars 23 stars Watchers 33 watching Forks 6 forks Report repository Releases No releases published Packages 0 No packages published Contributors 14 Languages Shell 100.0% Footer © 2025 GitHub, Inc. Footer navigation Terms Privacy Security Status Docs Contact Manage cookies Do not share my personal information You can’t perform that action at this time.

